{"version":3,"file":"ImageScript.js","mappings":"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","sources":["webpack://ImageScript/webpack/universalModuleDefinition","webpack://ImageScript/./ImageScript.js","webpack://ImageScript/./utils/buffer.js","webpack://ImageScript/./utils/crc32.js","webpack://ImageScript/./utils/png.js","webpack://ImageScript/./utils/wasm/font.js","webpack://ImageScript/./utils/wasm/gif.js","webpack://ImageScript/./utils/wasm/jpeg.js","webpack://ImageScript/./utils/wasm/svg.js","webpack://ImageScript/./utils/wasm/tiff.js","webpack://ImageScript/./utils/zlib.js","webpack://ImageScript/webpack/bootstrap","webpack://ImageScript/webpack/startup"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"ImageScript\"] = factory();\n\telse\n\t\troot[\"ImageScript\"] = factory();\n})(self, () => {\nreturn ","const png = require('./utils/png');\nconst mem = require('./utils/buffer.js');\nconst giflib = require('./utils/wasm/gif');\nconst svglib = require('./utils/wasm/svg');\nconst {version} = require('./package.json');\nconst fontlib = require('./utils/wasm/font');\nconst jpeglib = require('./utils/wasm/jpeg');\nconst tifflib = require('./utils/wasm/tiff');\n\nconst MAGIC_NUMBERS = {\n    PNG: 0x89504e47,\n    JPEG: 0xffd8ff,\n    TIFF: 0x49492a00,\n    GIF: 0x474946\n};\n\n/**\n * Represents an image; provides utility functions\n */\nclass Image {\n    /**\n     * Creates a new image with the given dimensions\n     * @param {number} width\n     * @param {number} height\n     * @returns {Image}\n     */\n    constructor(width, height) {\n        width = ~~width;\n        height = ~~height;\n\n        if (width < 1)\n            throw new RangeError('Image has to be at least 1 pixel wide');\n        if (height < 1)\n            throw new RangeError('Image has to be at least 1 pixel high');\n\n        /** @private */\n        this.__width__ = width;\n        /** @private */\n        this.__height__ = height;\n        /** @private */\n        this.__buffer__ = new ArrayBuffer(width * height * 4);\n        /** @private */\n        this.__view__ = new DataView(this.__buffer__);\n        /** @private */\n        this.__u32__ = new Uint32Array(this.__buffer__);\n        /**\n         * The images RGBA pixel data\n         * @type {Uint8ClampedArray}\n         */\n        this.bitmap = new Uint8ClampedArray(this.__buffer__);\n    }\n\n    /**\n     * @private\n     * @returns {string}\n     */\n    toString() {\n        return `Image<${this.width}x${this.height}>`;\n    }\n\n    /**\n     * The images width\n     * @returns {number}\n     */\n    get width() {\n        return this.__width__;\n    }\n\n    /**\n     * The images height\n     * @returns {number}\n     */\n    get height() {\n        return this.__height__;\n    }\n\n    /**\n     * Yields an [x, y] array for every pixel in the image\n     * @yields {number[]} The coordinates of the pixel ([x, y])\n     * @returns {void}\n     */\n    * [Symbol.iterator]() {\n        for (let y = 1; y <= this.height; y++) {\n            for (let x = 1; x <= this.width; x++) {\n                yield [x, y];\n            }\n        }\n    }\n\n    /**\n     * Yields an [x, y, color] array for every pixel in the image\n     * @yields {number[]} The coordinates and color of the pixel ([x, y, color])\n     */\n    * iterateWithColors() {\n        let offset = 0;\n        for (let y = 1; y <= this.height; y++) {\n            for (let x = 1; x <= this.width; x++) {\n                yield [x, y, this.__view__.getUint32(offset, false)];\n                offset += 4;\n            }\n        }\n    }\n\n    /**\n     * Converts RGBA components to an RGBA value\n     * @param {number} r red (0..255)\n     * @param {number} g green (0..255)\n     * @param {number} b blue (0..255)\n     * @param {number} a alpha (0..255)\n     * @returns {number} RGBA value\n     */\n    static rgbaToColor(r, g, b, a) {\n        return (((r & 0xff) << 24) | ((g & 0xff) << 16) | ((b & 0xff) << 8) | (a & 0xff)) >>> 0;\n    }\n\n    /**\n     * Converts RGB components to an RGBA value (assuming alpha = 255)\n     * @param {number} r red (0..255)\n     * @param {number} g green (0..255)\n     * @param {number} b blue (0..255)\n     * @returns {number} RGBA value\n     */\n    static rgbToColor(r, g, b) {\n        return Image.rgbaToColor(r, g, b, 0xff);\n    }\n\n    /**\n     * Converts HSLA colors to RGBA colors\n     * @param {number} h hue (0..1)\n     * @param {number} s saturation (0..1)\n     * @param {number} l lightness (0..1)\n     * @param {number} a opacity (0..1)\n     * @returns {number} color\n     */\n    static hslaToColor(h, s, l, a) {\n        h %= 1;\n        s = Math.min(1, Math.max(0, s));\n        l = Math.min(1, Math.max(0, l));\n        a = Math.min(1, Math.max(0, a));\n\n        let r, g, b;\n\n        if (s === 0) {\n            r = g = b = l;\n        } else {\n            const hue2rgb = (p, q, t) => {\n                if (t < 0) t += 1;\n                if (t > 1) t -= 1;\n                if (t < 1 / 6) return p + (q - p) * 6 * t;\n                if (t < 1 / 2) return q;\n                if (t < 2 / 3) return p + (q - p) * (2 / 3 - t) * 6;\n                return p;\n            };\n\n            const q = l < 0.5 ? l * (1 + s) : l + s - l * s;\n            const p = 2 * l - q;\n\n            r = hue2rgb(p, q, h + 1 / 3);\n            g = hue2rgb(p, q, h);\n            b = hue2rgb(p, q, h - 1 / 3);\n        }\n\n        return Image.rgbaToColor(r * 255, g * 255, b * 255, a * 255);\n    }\n\n    /**\n     * Converts HSL colors to RGBA colors (assuming an opacity of 255)\n     * @param {number} h hue (0..1)\n     * @param {number} s saturation (0..1)\n     * @param {number} l lightness (0..1)\n     * @returns {number} color\n     */\n    static hslToColor(h, s, l) {\n        return Image.hslaToColor(h, s, l, 1);\n    }\n\n    /**\n     * Converts an RGBA value to an array of HSLA values\n     * @param r {number} (0..255)\n     * @param g {number} (0..255)\n     * @param b {number} (0..255)\n     * @param a {number} (0..255)\n     * @returns {number[]} The HSLA values ([H, S, L, A])\n     */\n    static rgbaToHSLA(r, g, b, a) {\n        r /= 255;\n        g /= 255;\n        b /= 255;\n\n        const max = Math.max(r, g, b), min = Math.min(r, g, b);\n        let h, s, l = (max + min) / 2;\n\n        if (max === min) {\n            h = s = 0;\n        } else {\n            const d = max - min;\n            s = l > 0.5 ? d / (2 - max - min) : d / (max + min);\n            switch (max) {\n                case r:\n                    h = (g - b) / d + (g < b ? 6 : 0);\n                    break;\n                case g:\n                    h = (b - r) / d + 2;\n                    break;\n                case b:\n                    h = (r - g) / d + 4;\n                    break;\n            }\n\n            h /= 6;\n        }\n\n        return [h, s, l, a / 255];\n    }\n\n    /**\n     * Converts a color value to an array of RGBA values\n     * @param {number} color The color value to convert\n     * @returns {number[]} The RGBA values ([R, G, B, A])\n     */\n    static colorToRGBA(color) {\n        return [(color >> 24) & 0xff, (color >> 16) & 0xff, (color >> 8) & 0xff, color & 0xff];\n    }\n\n    /**\n     * Converts a color value to an array of RGB values (ignoring the colors alpha)\n     * @param {number} color The color value to convert\n     * @returns {number[]} The RGB values ([R, G, B])\n     */\n    static colorToRGB(color) {\n        return Image.colorToRGBA(color).slice(0, 3);\n    }\n\n    /**\n     * Gets the pixel color at the specified position\n     * @param {number} x\n     * @param {number} y\n     * @returns {number} The color value\n     */\n    getPixelAt(x, y) {\n        this.__check_boundaries__(x, y);\n        return this.__view__.getUint32(((~~y - 1) * this.width + (~~x - 1)) * 4, false);\n    }\n\n    /**\n     * Gets the pixel color at the specified position\n     * @param {number} x\n     * @param {number} y\n     * @returns {Uint8ClampedArray} The RGBA value\n     */\n    getRGBAAt(x, y) {\n        this.__check_boundaries__(x, y);\n        const idx = ((~~y - 1) * this.width + (~~x - 1)) * 4;\n        return this.bitmap.subarray(idx, idx + 4);\n    }\n\n    /**\n     * Sets the pixel color for the specified position\n     * @param {number} x\n     * @param {number} y\n     * @param {number} pixelColor\n     */\n    setPixelAt(x, y, pixelColor) {\n        x = ~~x;\n        y = ~~y;\n        this.__check_boundaries__(x, y);\n        this.__set_pixel__(x, y, pixelColor);\n        return this;\n    }\n\n    /**\n     * @private\n     * @param {number} x\n     * @param {number} y\n     * @param {number} pixelColor\n     */\n    __set_pixel__(x, y, pixelColor) {\n        this.__view__.setUint32(((y - 1) * this.width + (x - 1)) * 4, pixelColor, false);\n    }\n\n    /**\n     * @private\n     * @param {number} x\n     * @param {number} y\n     */\n    __check_boundaries__(x, y) {\n        if (isNaN(x)) throw new TypeError(`Invalid pixel coordinates (x=${x})`);\n        if (isNaN(y)) throw new TypeError(`Invalid pixel coordinates (y=${y})`);\n        if (x < 1)\n            throw new RangeError(`${Image.__out_of_bounds__} (x=${x})<1`);\n        if (x > this.width)\n            throw new RangeError(`${Image.__out_of_bounds__} (x=${x})>(width=${this.width})`);\n        if (y < 1)\n            throw new RangeError(`${Image.__out_of_bounds__} (y=${y})<1`);\n        if (y > this.height)\n            throw new RangeError(`${Image.__out_of_bounds__} (y=${y})>(height=${this.height})`);\n    }\n\n    /**\n     * @private\n     */\n    static get __out_of_bounds__() {\n        return 'Tried referencing a pixel outside of the images boundaries:';\n    }\n\n    /**\n     * @callback colorFunction\n     * @param {number} x\n     * @param {number} y\n     * @returns {number} pixel color\n     */\n\n    /**\n     * Fills the image data with the supplied color\n     * @param {number|colorFunction} color\n     * @returns {Image}\n     */\n    fill(color) {\n        const type = typeof color;\n        if (type !== 'function') {\n            this.__view__.setUint32(0, color, false);\n            this.__u32__.fill(this.__u32__[0]);\n        } else {\n            let offset = 0;\n            for (let y = 1; y <= this.height; y++) {\n                for (let x = 1; x <= this.width; x++) {\n                    this.__view__.setUint32(offset, color(x, y), false);\n                    offset += 4;\n                }\n            }\n        }\n\n        return this;\n    }\n\n    /**\n     * Clones the current image\n     * @returns {Image}\n     */\n    clone() {\n        const image = new Image(this.width, this.height);\n        image.bitmap.set(this.bitmap);\n        return image;\n    }\n\n    /**\n     * Use {@link https://en.wikipedia.org/wiki/Image_scaling#Nearest-neighbor_interpolation Nearest-neighbor} resizing.\n     * @returns {string}\n     */\n    static get RESIZE_NEAREST_NEIGHBOR() {\n        return 'RESIZE_NEAREST_NEIGHBOR';\n    }\n\n    /**\n     * Used for automatically preserving an images aspect ratio when resizing.\n     * @returns {number}\n     */\n    static get RESIZE_AUTO() {\n        return -1;\n    }\n\n    /**\n     * Resizes the image by the given factor\n     * @param {number} factor The factor to resize the image with\n     * @param {string} [mode=Image.RESIZE_NEAREST_NEIGHBOR] The resizing mode to use\n     * @returns {Image}\n     */\n    scale(factor, mode = Image.RESIZE_NEAREST_NEIGHBOR) {\n        const image = this.__scale__(factor, mode);\n        return this.__apply__(image);\n    }\n\n    /** @private */\n    __scale__(factor, mode = Image.RESIZE_NEAREST_NEIGHBOR) {\n        if (factor === 1) return this;\n        return this.__resize__(this.width * factor, this.height * factor, mode);\n    }\n\n    /**\n     * Resizes the image to the given dimensions.\n     * Use {@link Image.RESIZE_AUTO} as either width or height to automatically preserve the aspect ratio.\n     * @param {number} width The new width\n     * @param {number} height The new height\n     * @param {string} [mode=Image.RESIZE_NEAREST_NEIGHBOR] The resizing mode to use\n     * @returns {Image} The resized image\n     */\n    resize(width, height, mode = Image.RESIZE_NEAREST_NEIGHBOR) {\n        const image = this.__resize__(width, height, mode);\n        return this.__apply__(image);\n    }\n\n    /**\n     * Resizes the image so it is contained in the given bounding box.\n     * Can return an image with one axis smaller than the given bounding box.\n     * @param {number} width The width of the bounding box\n     * @param {number} height The height of the bounding box\n     * @param {string} [mode=Image.RESIZE_NEAREST_NEIGHBOR] The resizing mode to use\n     * @returns {Image} The resized image\n     */\n    contain(width, height, mode = Image.RESIZE_NEAREST_NEIGHBOR) {\n        const scaleFactor = width / height > this.width / this.height ? height / this.height : width / this.width;\n        return this.scale(scaleFactor, mode);\n    }\n\n    /**\n     * Resizes the image so it is contained in the given bounding box, placing it in the center of the given bounding box.\n     * Always returns the exact dimensions of the bounding box.\n     * @param {number} width The width of the bounding box\n     * @param {number} height The height of the bounding box\n     * @param {string} [mode=Image.RESIZE_NEAREST_NEIGHBOR] The resizing mode to use\n     * @returns {Image} The resized image\n     */\n    fit(width, height, mode = Image.RESIZE_NEAREST_NEIGHBOR) {\n        const result = new Image(width, height);\n        this.contain(width, height, mode);\n        result.composite(this, (width - this.width) / 2, (height - this.height) / 2);\n        return this.__apply__(result);\n    }\n\n    /**\n     * Resizes the image so it covers the given bounding box, cropping the overflowing edges.\n     * Always returns the exact dimensions of the bounding box.\n     * @param {number} width The width of the bounding box\n     * @param {number} height The height of the bounding box\n     * @param {string} [mode=Image.RESIZE_NEAREST_NEIGHBOR] The resizing mode to use\n     * @returns {Image} The resized image\n     */\n    cover(width, height, mode = Image.RESIZE_NEAREST_NEIGHBOR) {\n        const scaleFactor = width / height > this.width / this.height ? width / this.width : height / this.height;\n        const result = this.scale(scaleFactor, mode);\n        return result.crop((result.width - width) / 2, (result.height - height) / 2, width, height);\n    }\n\n    /** @private */\n    __resize__(width, height, mode = Image.RESIZE_NEAREST_NEIGHBOR) {\n        if (width === Image.RESIZE_AUTO && height === Image.RESIZE_AUTO) throw new Error('RESIZE_AUTO can only be used for either width or height, not for both');\n        else if (width === Image.RESIZE_AUTO) width = this.width / this.height * height;\n        else if (height === Image.RESIZE_AUTO) height = this.height / this.width * width;\n\n        width = Math.floor(width);\n        height = Math.floor(height);\n        if (width < 1)\n            throw new RangeError('Image has to be at least 1 pixel wide');\n        if (height < 1)\n            throw new RangeError('Image has to be at least 1 pixel high');\n\n        let image;\n        if (mode === Image.RESIZE_NEAREST_NEIGHBOR)\n            image = this.__resize_nearest_neighbor__(width, height);\n        else throw new Error('Invalid resize mode');\n\n        return image;\n    }\n\n    /**\n     * @private\n     * @param {number} width The new width\n     * @param {number} height The new height\n     */\n    __resize_nearest_neighbor__(width, height) {\n        const image = new this.constructor(width, height);\n\n        for (let y = 0; y < height; y++) {\n            for (let x = 0; x < width; x++) {\n                const ySrc = Math.floor((y * this.height) / height);\n                const xSrc = Math.floor((x * this.width) / width);\n\n                const destPos = (y * width + x) * 4;\n                const srcPos = (ySrc * this.width + xSrc) * 4;\n\n                image.__view__.setUint32(destPos, this.__view__.getUint32(srcPos, false), false);\n            }\n        }\n\n        return image;\n    }\n\n    /**\n     * Crops an image to the specified dimensions\n     * @param {number} x The x offset\n     * @param {number} y The y offset\n     * @param {number} width The new images width\n     * @param {number} height The new images height\n     * @returns {Image}\n     */\n    crop(x, y, width, height) {\n        if (width > this.width) width = this.width;\n        if (height > this.height) height = this.height;\n\n        return this.__apply__(this.__crop__(~~x, ~~y, ~~width, ~~height));\n    }\n\n    /**\n     * @param {number} x\n     * @param {number} y\n     * @param {number} width\n     * @param {number} height\n     * @returns {Image}\n     * @private\n     */\n    __crop__(x, y, width, height) {\n        x = ~~x;\n        y = ~~y;\n\n        const image = new this.constructor(width, height);\n\n        for (let tY = 0; tY < height; tY++) {\n            const idx = (tY + y) * this.width + x;\n            image.__u32__.set(this.__u32__.subarray(idx, idx + width), tY * width);\n        }\n\n        return image;\n    }\n\n    /**\n     * Draws a box at the specified coordinates\n     * @param {number} x The x offset\n     * @param {number} y The y offset\n     * @param {number} width The box width\n     * @param {number} height The box height\n     * @param {number|colorFunction} color The color to fill the box in with\n     * @returns {Image}\n     */\n    drawBox(x, y, width, height, color) {\n        x = ~~(x - 1);\n        y = ~~(y - 1);\n        width = ~~width;\n        height = ~~height;\n\n        if (typeof color === 'function') {\n            for (let tY = 1; tY <= height; tY++) {\n                for (let tX = 1; tX <= width; tX++) {\n                    const nX = tX + x;\n                    const nY = tY + y;\n                    if (Math.min(nX, nY) < 1 || nX > this.width || nY > this.height)\n                        continue;\n\n                    const tC = color(tX, tY);\n                    this.__set_pixel__(nX, nY, tC);\n                }\n            }\n        } else return this.__fast_box__(x, y, width, height, color);\n\n        return this;\n    }\n\n    /**\n     * @private\n     * @param {number} x\n     * @param {number} y\n     * @param {number} width\n     * @param {number} height\n     * @param {number} color\n     */\n    __fast_box__(x, y, width, height, color) {\n        if (x < 0) {\n            width += x;\n            x = 0;\n        }\n\n        if (y < 0) {\n            height += y;\n            y = 0;\n        }\n\n        const right = Math.max(Math.min(x + width, this.width), 1);\n        let xPos = right;\n        while (x <= --xPos)\n            this.__view__.setUint32(4 * (xPos + y * this.width), color);\n        const end = 4 * (right + y * this.width);\n        const start = 4 * (x + y * this.width);\n\n        let bottom = Math.max(Math.min(y + height, this.height), 1);\n        while (y < --bottom)\n            this.bitmap.copyWithin(4 * (x + bottom * this.width), start, end);\n\n        return this;\n    }\n\n    /**\n     * Draws a circle at the specified coordinates with the specified radius\n     * @param {number} x The center x position\n     * @param {number} y The center y position\n     * @param {number} radius The circles radius\n     * @param {number|colorFunction} color\n     * @returns {Image}\n     */\n    drawCircle(x, y, radius, color) {\n        const radSquared = radius ** 2;\n        for (let currentY = Math.max(1, y - radius); currentY <= Math.min(y + radius, this.height); currentY++) {\n            for (let currentX = Math.max(1, x - radius); currentX <= Math.min(x + radius, this.width); currentX++) {\n                if ((currentX - x) ** 2 + (currentY - y) ** 2 < radSquared)\n                    this.__set_pixel__(currentX, currentY, typeof color === 'function' ? color(currentX - x + radius, currentY - y + radius) : color);\n            }\n        }\n\n        return this;\n    }\n\n    /**\n     * Crops the image into a circle\n     * @param {boolean} [max=false] Whether to use the larger dimension for the size\n     * @param {number} [feathering=0] How much feathering to apply to the edges\n     * @returns {Image}\n     */\n    cropCircle(max = false, feathering = 0) {\n        const rad = Math[max ? 'max' : 'min'](this.width, this.height) / 2;\n        const radSquared = rad ** 2;\n        const centerX = this.width / 2;\n        const centerY = this.height / 2;\n\n        for (const [x, y] of this) {\n            const distanceFromCenter = (x - centerX) ** 2 + (y - centerY) ** 2;\n            const alphaIdx = ((y - 1) * this.width + (x - 1)) * 4 + 3;\n            if (distanceFromCenter > radSquared)\n                this.bitmap[alphaIdx] = 0;\n            else if (feathering)\n                this.bitmap[alphaIdx] *= Math.max(0, Math.min(1, 1 - (distanceFromCenter / radSquared) * feathering ** (1 / 2)));\n        }\n\n        return this;\n    }\n\n    /**\n     * Sets the images opacity\n     * @param {number} opacity The opacity to apply (0..1)\n     * @param {boolean} absolute Whether to scale the current opacity (false) or just set the new opacity (true)\n     * @returns {Image}\n     */\n    opacity(opacity, absolute = false) {\n        if (isNaN(opacity) || opacity < 0)\n            throw new RangeError('Invalid opacity value');\n\n        this.__set_channel_value__(opacity, absolute, 3);\n\n        return this;\n    }\n\n    /**\n     * Sets the red channels saturation\n     * @param {number} saturation The saturation to apply (0..1)\n     * @param {boolean} absolute Whether to scale the current saturation (false) or just set the new saturation (true)\n     * @returns {Image}\n     */\n    red(saturation, absolute = false) {\n        if (isNaN(saturation) || saturation < 0)\n            throw new RangeError('Invalid saturation value');\n\n        this.__set_channel_value__(saturation, absolute, 0);\n\n        return this;\n    }\n\n    /**\n     * Sets the green channels saturation\n     * @param {number} saturation The saturation to apply (0..1)\n     * @param {boolean} absolute Whether to scale the current saturation (false) or just set the new saturation (true)\n     * @returns {Image}\n     */\n    green(saturation, absolute = false) {\n        if (isNaN(saturation) || saturation < 0)\n            throw new RangeError('Invalid saturation value');\n\n        this.__set_channel_value__(saturation, absolute, 1);\n\n        return this;\n    }\n\n    /**\n     * Sets the blue channels saturation\n     * @param {number} saturation The saturation to apply (0..1)\n     * @param {boolean} absolute Whether to scale the current saturation (false) or just set the new saturation (true)\n     * @returns {Image}\n     */\n    blue(saturation, absolute = false) {\n        if (isNaN(saturation) || saturation < 0)\n            throw new RangeError('Invalid saturation value');\n\n        this.__set_channel_value__(saturation, absolute, 2);\n\n        return this;\n    }\n\n    /**\n     * @private\n     * @param {number} value\n     * @param {boolean} absolute\n     * @param {number} offset\n     */\n    __set_channel_value__(value, absolute, offset) {\n        for (let i = offset; i < this.bitmap.length; i += 4)\n            this.bitmap[i] = value * (absolute ? 255 : this.bitmap[i]);\n    }\n\n    /**\n     * Sets the brightness of the image\n     * @param {number} value The lightness to apply (0..1)\n     * @param {boolean} absolute Whether to scale the current lightness (false) or just set the new lightness (true)\n     * @returns {Image}\n     */\n    lightness(value, absolute = false) {\n        if (isNaN(value) || value < 0)\n            throw new RangeError('Invalid lightness value');\n\n        return this.fill((x, y) => {\n            const [h, s, l, a] = Image.rgbaToHSLA(...this.getRGBAAt(x, y));\n            return Image.hslaToColor(h, s, value * (absolute ? 1 : l), a);\n        });\n    }\n\n    /**\n     * Sets the saturation of the image\n     * @param {number} value The saturation to apply (0..1)\n     * @param {boolean} absolute Whether to scale the current saturation (false) or just set the new saturation (true)\n     * @returns {Image}\n     */\n    saturation(value, absolute = false) {\n        if (isNaN(value) || value < 0)\n            throw new RangeError('Invalid saturation value');\n\n        return this.fill((x, y) => {\n            const [h, s, l, a] = Image.rgbaToHSLA(...this.getRGBAAt(x, y));\n            return Image.hslaToColor(h, value * (absolute ? 1 : s), l, a);\n        });\n    }\n\n    /**\n     * Composites (overlays) the source onto this image at the specified coordinates\n     * @param {Image} source The image to place\n     * @param {number} [x=0] The x position to place the image at\n     * @param {number} [y=0] The y position to place the image at\n     * @returns {Image}\n     */\n    composite(source, x = 0, y = 0) {\n        x = ~~x;\n        y = ~~y;\n\n        for (let yy = 0; yy < source.height; yy++) {\n            let y_offset = y + yy;\n            if (y_offset < 0) continue;\n            if (y_offset >= this.height) break;\n\n            for (let xx = 0; xx < source.width; xx++) {\n                let x_offset = x + xx;\n                if (x_offset < 0) continue;\n                if (x_offset >= this.width) break;\n\n                const offset = 4 * (x_offset + y_offset * this.width);\n                const fg = source.__view__.getUint32(4 * (xx + yy * source.width), false);\n                const bg = this.__view__.getUint32(offset, false);\n\n                if ((fg & 0xff) === 0xff) this.__view__.setUint32(offset, fg, false);\n                else if ((fg & 0xff) === 0x00) this.__view__.setUint32(offset, bg, false);\n                else this.__view__.setUint32(offset, Image.__alpha_blend__(fg, bg), false);\n            }\n        }\n\n        return this;\n    }\n\n    /**\n     * @private\n     * @param {number} fg\n     * @param {number} bg\n     * @returns {number}\n     */\n    static __alpha_blend__(fg, bg) {\n        const fa = fg & 0xff;\n        const alpha = fa + 1;\n        const inv_alpha = 256 - fa;\n        const r = (alpha * (fg >>> 24) + inv_alpha * (bg >>> 24)) >> 8;\n        const b = (alpha * (fg >> 8 & 0xff) + inv_alpha * (bg >> 8 & 0xff)) >> 8;\n        const g = (alpha * (fg >> 16 & 0xff) + inv_alpha * (bg >> 16 & 0xff)) >> 8;\n        return (((r & 0xff) << 24) | ((g & 0xff) << 16) | ((b & 0xff) << 8) | (Math.max(fa, bg & 0xff) & 0xff));\n    }\n\n    /**\n     * Inverts the images colors\n     * @returns {Image}\n     */\n    invert() {\n        for (const [x, y, color] of this.iterateWithColors())\n            this.__set_pixel__(x, y, ((0xffffffff - color) & 0xffffff00) | (color & 0xff));\n\n        return this;\n    }\n\n    /**\n     * Inverts the images value (lightness)\n     * @returns {Image}\n     */\n    invertValue() {\n        for (const [x, y, color] of this.iterateWithColors()) {\n            const [h, s, l, a] = Image.rgbaToHSLA(...Image.colorToRGBA(color));\n            this.__set_pixel__(x, y, Image.hslaToColor(h, s, 1 - l, a));\n        }\n\n        return this;\n    }\n\n    /**\n     * Inverts the images saturation\n     * @returns {Image}\n     */\n    invertSaturation() {\n        for (const [x, y, color] of this.iterateWithColors()) {\n            const [h, s, l, a] = Image.rgbaToHSLA(...Image.colorToRGBA(color));\n            this.__set_pixel__(x, y, Image.hslaToColor(h, 1 - s, l, a));\n        }\n\n        return this;\n    }\n\n    /**\n     * Inverts the images hue\n     * @returns {Image}\n     */\n    invertHue() {\n        for (const [x, y, color] of this.iterateWithColors()) {\n            const [h, s, l, a] = Image.rgbaToHSLA(...Image.colorToRGBA(color));\n            this.__set_pixel__(x, y, Image.hslaToColor(1 - h, s, l, a));\n        }\n\n        return this;\n    }\n\n    /**\n     * Shifts the images hue\n     * @param {number} degrees How many degrees to shift the hue by\n     */\n    hueShift(degrees) {\n        for (const [x, y, color] of this.iterateWithColors()) {\n            const [h, s, l, a] = Image.rgbaToHSLA(...Image.colorToRGBA(color));\n            this.__set_pixel__(x, y, Image.hslaToColor(h + degrees / 360, s, l, a));\n        }\n\n        return this;\n    }\n\n    /**\n     * Gets the average color of the image\n     * @returns {number}\n     */\n    averageColor() {\n        let colorAvg = [0, 0, 0];\n        let divisor = 0;\n        for (let idx = 0; idx < this.bitmap.length; idx += 4) {\n            const rgba = this.bitmap.subarray(idx, idx + 4);\n            for (let i = 0; i < 3; i++)\n                colorAvg[i] += rgba[i];\n            divisor += rgba[3] / 255;\n        }\n\n        return Image.rgbaToColor(...colorAvg.map(v => v / divisor), 0xff);\n    }\n\n    /**\n     * Gets the images dominant color\n     * @param {boolean} [ignoreBlack=true] Whether to ignore dark colors below the threshold\n     * @param {boolean} [ignoreWhite=true] Whether to ignore light colors above the threshold\n     * @param {number} [bwThreshold=0xf] The black/white threshold (0-64)\n     * @return {number} The images dominant color\n     */\n    dominantColor(ignoreBlack = true, ignoreWhite = true, bwThreshold = 0xf) {\n        const colorCounts = new Array(0x3ffff);\n        for (let i = 0; i < this.bitmap.length; i += 4) {\n            const color = this.__view__.getUint32(i, false);\n            const [h, s, l] = Image.rgbaToHSLA(...Image.colorToRGBA(color)).map(v => (~~(v * 0x3f)));\n            if (ignoreBlack && l < bwThreshold) continue;\n            if (ignoreWhite && l > 0x3f - bwThreshold) continue;\n            const key = h << 12 | s << 6 | l;\n            colorCounts[key] = (colorCounts[key] || 0) + 1;\n        }\n\n        let maxColorCount = -1;\n        let mostProminentValue = 0;\n        colorCounts.forEach((el, i) => {\n            if (el < maxColorCount) return;\n            maxColorCount = el;\n            mostProminentValue = i;\n        });\n\n        if (mostProminentValue === -1)\n            return this.dominantColor(ignoreBlack, ignoreWhite, bwThreshold - 1);\n\n        const h = (mostProminentValue >>> 12) & 0x3f;\n        const s = (mostProminentValue >>> 6) & 0x3f;\n        const l = mostProminentValue & 0x3f;\n\n        return Image.hslaToColor(h / 0x3f, s / 0x3f, l / 0x3f, 1);\n    }\n\n    /**\n     * Rotates the image the given amount of degrees\n     * @param {number} angle The angle to rotate the image for (in degrees)\n     * @param {boolean} resize Whether to resize the image so it fits all pixels or just ignore outlying pixels\n     */\n    rotate(angle, resize = true) {\n        if (angle % 360 === 0) return this;\n        if (angle % 180 === 0) return this.__rotate_180__();\n\n        const rad = Math.PI * (angle / 180);\n\n        const sin = Math.sin(rad);\n        const cos = Math.cos(rad);\n\n        const width = resize\n            ? Math.abs(this.width * sin) + Math.abs(this.height * cos)\n            : this.width;\n        const height = resize\n            ? Math.abs(this.width * cos) + Math.abs(this.height * sin)\n            : this.height;\n\n        const out = new Image(width, height);\n\n        const out_cx = width / 2 - .5;\n        const out_cy = height / 2 - .5;\n        const src_cx = this.width / 2 - .5;\n        const src_cy = this.height / 2 - .5;\n\n        let h = 0;\n        do {\n            let w = 0;\n            const ysin = src_cx - sin * (h - out_cy);\n            const ycos = src_cy + cos * (h - out_cy);\n\n            do {\n                const xf = ysin + cos * (w - out_cx);\n                const yf = ycos + sin * (w - out_cx);\n                Image.__interpolate__(this, out, w, h, xf, yf);\n            } while (w++ < width);\n        } while (h++ < height);\n\n        return this.__apply__(out);\n    }\n\n    /**\n     * @returns {Image}\n     * @private\n     */\n    __rotate_180__() {\n        let offset = 0;\n        this.bitmap.reverse();\n        while (offset < this.bitmap.length) this.bitmap.subarray(offset, offset += 4).reverse();\n\n        return this;\n    }\n\n    /**\n     * @param {Image} src\n     * @param {Image} out\n     * @param {number} x0\n     * @param {number} y0\n     * @param {number} x1\n     * @param {number} y1\n     * @private\n     */\n    static __interpolate__(src, out, x0, y0, x1, y1) {\n        const x2 = ~~x1;\n        const y2 = ~~y1;\n        const xq = x1 - x2;\n        const yq = y1 - y2;\n        const out_slice = out.bitmap.subarray(4 * (x0 + y0 * out.width), -4);\n\n        const ref = {\n            r: 0,\n            g: 0,\n            b: 0,\n            a: 0,\n        };\n\n        Image.__pawn__(x2, y2, (1 - xq) * (1 - yq), ref, src);\n        Image.__pawn__(1 + x2, y2, xq * (1 - yq), ref, src);\n        Image.__pawn__(x2, 1 + y2, (1 - xq) * yq, ref, src);\n        Image.__pawn__(1 + x2, 1 + y2, xq * yq, ref, src);\n\n        out_slice[3] = ref.a;\n        out_slice[0] = ref.r / ref.a;\n        out_slice[1] = ref.g / ref.a;\n        out_slice[2] = ref.b / ref.a;\n    }\n\n    /** @private */\n    static __pawn__(point0, point1, weight, ref, src) {\n        if (\n            point0 > 0\n            && point1 > 0\n            && point0 < src.width\n            && point1 < src.height\n        ) {\n            const offset = 4 * (point0 + point1 * src.width);\n            const src_slice = src.bitmap.subarray(offset, offset + 4);\n\n            const wa = weight * src_slice[3];\n\n            ref.a += wa;\n            ref.r += wa * src_slice[0];\n            ref.g += wa * src_slice[1];\n            ref.b += wa * src_slice[2];\n        }\n    }\n\n    /**\n     * @private\n     * @param {Image|Frame} image\n     * @returns {Image|Frame}\n     */\n    __apply__(image) {\n        this.__width__ = image.__width__;\n        this.__height__ = image.__height__;\n        this.__view__ = image.__view__;\n        this.__u32__ = image.__u32__;\n        this.bitmap = image.bitmap;\n\n        if (image instanceof Frame)\n            return Frame.from(this, image.duration, image.xOffset, image.yOffset, image.disposalMode);\n\n        return this;\n    }\n\n    /**\n     * Creates a multi-point gradient generator\n     * @param {Object<number, number>} colors The gradient points to use (e.g. `{0: 0xff0000ff, 1: 0x00ff00ff}`)\n     * @return {(function(number): number)} The gradient generator. The function argument is the position in the gradient (0..1).\n     */\n    static gradient(colors) {\n        const entries = Object.entries(colors).sort((a, b) => a[0] - b[0]);\n        const positions = entries.map(e => parseFloat(e[0]));\n        const values = entries.map(e => e[1]);\n\n        if (positions.length === 0) throw new RangeError('Invalid gradient point count');\n        else if (positions.length === 1) {\n            return () => values[0];\n        } else if (positions.length === 2) {\n            const gradient = this.__gradient__(values[0], values[1]);\n            return position => {\n                if (position <= positions[0]) return values[0];\n                if (position >= positions[1]) return values[1];\n                return gradient((position - positions[0]) / (positions[1] - positions[0]));\n            };\n        }\n\n        const minDef = Math.min(...positions);\n        const maxDef = Math.max(...positions);\n        let gradients = [];\n\n        for (let i = 0; i < positions.length; i++) {\n            let minPos = positions[i - 1];\n            if (minPos === undefined) continue;\n\n            let maxPos = positions[i];\n\n            let minVal = values[i - 1];\n            if (minVal === undefined) minVal = values[i];\n\n            const maxVal = values[i];\n            const gradient = this.__gradient__(minVal, maxVal);\n\n            gradients.push({min: minPos, max: maxPos, gradient});\n        }\n\n        return position => {\n            if (position <= minDef) return gradients[0].gradient(0);\n            if (position >= maxDef) return gradients[gradients.length - 1].gradient(1);\n\n            for (const gradient of gradients)\n                if (position >= gradient.min && position <= gradient.max)\n                    return gradient.gradient((position - gradient.min) / (gradient.max - gradient.min));\n            throw new RangeError(`Invalid gradient position: ${position}`);\n        };\n    }\n\n    /**\n     * Rounds the images corners\n     * @param {number} [radius=min(width,height)/4] The radius of the corners\n     * @return {Image}\n     */\n    roundCorners(radius = Math.min(this.width, this.height) / 4) {\n        const radSquared = radius ** 2;\n        for (let x = 1; x <= radius; x++) {\n            const xRad = (x - radius) ** 2;\n            for (let y = 1; y <= radius; y++) {\n                if (xRad + (y - radius) ** 2 > radSquared)\n                    this.bitmap[((y - 1) * this.width + x - 1) * 4 + 3] = 0;\n            }\n        }\n\n        for (let x = 1; x <= radius; x++) {\n            const xRad = (x - radius) ** 2;\n            for (let y = this.height - radius; y <= this.height; y++) {\n                if (xRad + ((this.height - y) - radius) ** 2 > radSquared)\n                    this.bitmap[((y - 1) * this.width + x - 1) * 4 + 3] = 0;\n            }\n        }\n\n        for (let x = this.width - radius; x <= this.width; x++) {\n            const xRad = ((this.width - x) - radius) ** 2;\n            for (let y = 1; y <= radius; y++) {\n                if (xRad + (y - radius) ** 2 > radSquared)\n                    this.bitmap[((y - 1) * this.width + x - 1) * 4 + 3] = 0;\n            }\n        }\n\n        for (let x = this.width - radius; x <= this.width; x++) {\n            const xRad = ((this.width - x) - radius) ** 2;\n            for (let y = this.height - radius; y <= this.height; y++) {\n                if (xRad + ((this.height - y) - radius) ** 2 > radSquared)\n                    this.bitmap[((y - 1) * this.width + x - 1) * 4 + 3] = 0;\n            }\n        }\n\n        return this;\n    }\n\n    /**\n     * @private\n     */\n    static __gradient__(startColor, endColor) {\n        const sr = startColor >>> 24;\n        const sg = startColor >> 16 & 0xff;\n        const sb = startColor >> 8 & 0xff;\n        const sa = startColor & 0xff;\n        const er = (endColor >>> 24) - sr;\n        const eg = (endColor >> 16 & 0xff) - sg;\n        const eb = (endColor >> 8 & 0xff) - sb;\n        const ea = (endColor & 0xff) - sa;\n\n        return position => {\n            const r = sr + position * er;\n            const g = sg + position * eg;\n            const b = sb + position * eb;\n            const a = sa + position * ea;\n            return (((r & 0xff) << 24) | ((g & 0xff) << 16) | ((b & 0xff) << 8) | (a & 0xff));\n        };\n    }\n\n    fisheye(radius = 2) {\n        const r = new Image(this.width, this.height);\n\n        const w = this.width;\n        const h = this.height;\n        const tu32 = this.__u32__;\n        const ru32 = r.__u32__;\n        const iw = 1 / w;\n        const ih = 1 / h;\n\n        for (const [x, y] of this) {\n            const xco = x * iw - .5;\n            const yco = y * ih - .5;\n            const dfc = Math.sqrt(xco ** 2 + yco ** 2);\n            const dis = 2 * dfc ** radius;\n            const nx = ((dis * xco / dfc + 0.5) * w) | 0;\n            const ny = ((dis * yco / dfc + 0.5) * h) | 0;\n\n            if (nx < 1 || nx > w || ny < 1 || ny > h || isNaN(nx) || isNaN(ny))\n                continue;\n\n            ru32[y * w + x] = tu32[w * ny + nx];\n        }\n\n        const cO = tu32.length * .5 + w / 2;\n        ru32[cO] = tu32[cO];\n\n        return this.__apply__(r);\n    }\n\n    /**\n     * @typedef {object} PNGMetadata\n     * @property {string} [title] The images title\n     * @property {string} [author] The images author\n     * @property {string} [description] The images description\n     * @property {string} [copyright] The images copyright info\n     * @property {string|number|Date} [creationTime=Date.now()] The images creation timestamp\n     * @property {string} [software=\"github.com/matmen/ImageScript vX.X.X\"] The software used to create this image\n     * @property {string} [disclaimer] A disclaimer for the image\n     * @property {string} [warning] A warning for the image\n     * @property {string} [source] The images source\n     * @property {string} [comment] A comment for the image\n     */\n\n    /**\n     * Encodes the image into a PNG\n     * @param {number} compression The compression level to use (0-9)\n     * @param {PNGMetadata} [meta={}] Image metadata\n     * @return {Promise<Uint8Array>} The encoded data\n     */\n    async encode(compression = 1, {\n        title,\n        author,\n        description,\n        copyright,\n        creationTime,\n        software,\n        disclaimer,\n        warning,\n        source,\n        comment\n    } = {}) {\n        return png.encode(this.bitmap, {\n            width: this.width,\n            height: this.height,\n            level: compression,\n            channels: 4,\n            text: {\n                Title: title,\n                Author: author,\n                Description: description,\n                Copyright: copyright,\n                'Creation Time': new Date(creationTime === undefined ? Date.now() : creationTime).toUTCString(),\n                Software: software === undefined ? `github.com/matmen/ImageScript v${version}` : software,\n                Disclaimer: disclaimer,\n                Warning: warning,\n                Source: source,\n                Comment: comment\n            }\n        });\n    }\n\n    /**\n     * Encodes the image into a JPEG\n     * @param {number} [quality=90] The JPEG quality to use (1-100)\n     * @return {Promise<Uint8Array>}\n     */\n    async encodeJPEG(quality = 90) {\n        return (await jpeglib.init()).encode(this.bitmap, this.width, this.height, quality);\n    }\n\n    /**\n     * Decodes an image (PNG, JPEG or TIFF)\n     * @param {Buffer|Uint8Array} data The binary data to decode\n     * @return {Promise<Image>} The decoded image\n     */\n    static async decode(data) {\n        let image;\n\n        data = mem.view(data);\n        const view = new DataView(data.buffer, data.byteOffset, data.byteLength);\n\n        if (ImageType.isPNG(view)) { // PNG\n            const {width, height, pixels} = png.decode(data);\n            image = new Image(width, height);\n            image.bitmap.set(pixels);\n        } else if (ImageType.isJPEG(view)) { // JPEG\n            const framebuffer = (await jpeglib.init()).decode(data);\n\n            const width = framebuffer.width;\n            const height = framebuffer.height;\n            const pixelType = framebuffer.format;\n\n            image = new Image(width, height);\n            const buffer = framebuffer.buffer;\n\n            if (pixelType === 0) {\n                const view = new DataView(image.bitmap.buffer);\n\n                for (let i = 0; i < buffer.length; i++) {\n                    const pixel = buffer[i];\n                    view.setUint32(i * 4, pixel << 24 | pixel << 16 | pixel << 8 | 0xff, false);\n                }\n            } else if (pixelType === 1) {\n                image.bitmap.fill(0xff);\n                for (let i = 0; i < width * height; i++)\n                    image.bitmap.set(buffer.subarray(i * 3, i * 3 + 3), i * 4);\n            } else if (pixelType === 2) {\n                for (let i = 0; i < buffer.length; i += 4) {\n                    image.bitmap[i] = 0xff * (1 - buffer[i] / 0xff) * (1 - buffer[i + 3] / 0xff);\n                    image.bitmap[i + 1] = 0xff * (1 - buffer[i + 1] / 0xff) * (1 - buffer[i + 3] / 0xff);\n                    image.bitmap[i + 2] = 0xff * (1 - buffer[i + 2] / 0xff) * (1 - buffer[i + 3] / 0xff);\n                    image.bitmap[i + 3] = 0xff;\n                }\n            }\n        } else if (ImageType.isTIFF(view)) { // TIFF\n            const framebuffer = (await tifflib.init()).decode(data);\n            image = new Image(framebuffer.width, framebuffer.height);\n\n            image.bitmap.set(framebuffer.buffer);\n        } else throw new Error('Unsupported image type');\n\n        return image;\n    }\n\n    /**\n     * Scale the SVG by the given amount. For use with {@link Image.renderSVG}\n     * @return {number}\n     */\n    static get SVG_MODE_SCALE() {\n        return 1;\n    }\n\n    /**\n     * Scale the SVG to fit the given width. For use with {@link Image.renderSVG}\n     * @return {number}\n     */\n    static get SVG_MODE_WIDTH() {\n        return 2;\n    }\n\n    /**\n     * Scale the SVG to fit the given height. For use with {@link Image.renderSVG}\n     * @return {number}\n     */\n    static get SVG_MODE_HEIGHT() {\n        return 3;\n    }\n\n    /**\n     * Creates a new image from the given SVG\n     * @param {string} svg The SVG content\n     * @param {number} size The size to use\n     * @param {number} mode The SVG resizing mode to use (one of {@link SVG_MODE_SCALE}, {@link SVG_MODE_WIDTH}, {@link SVG_MODE_HEIGHT})\n     * @return {Promise<Image>} The rendered SVG graphic\n     */\n    static async renderSVG(svg, size = 1, mode = this.SVG_MODE_SCALE) {\n        if (![this.SVG_MODE_WIDTH, this.SVG_MODE_HEIGHT, this.SVG_MODE_SCALE].includes(mode))\n            throw new Error('Invalid SVG scaling mode');\n\n        if (mode === this.SVG_MODE_SCALE && size <= 0)\n            throw new RangeError('SVG scale must be > 0');\n        if (mode !== this.SVG_MODE_SCALE && size < 1)\n            throw new RangeError('SVG size must be >= 1')\n\n        if (typeof svg === 'string') svg = new TextEncoder().encode(svg);\n        const framebuffer = (await svglib.init()).rasterize(svg, mode, size);\n\n        const image = new Image(framebuffer.width, framebuffer.height);\n\n        image.bitmap.set(framebuffer.buffer);\n\n        return image;\n    }\n\n    /**\n     * Creates a new image containing the rendered text.\n     * @param {Uint8Array} font TrueType (ttf/ttc) or OpenType (otf) font buffer to use\n     * @param {number} scale Font size to use\n     * @param {string} text Text to render\n     * @param {number} [color=0xffffffff] Text color to use\n     * @param {TextLayout} [layout] The text layout to use\n     * @return {Promise<Image>} The rendered text\n     */\n    static async renderText(font, scale, text, color = 0xffffffff, layout = new TextLayout()) {\n        const { Font, Layout } = await fontlib.init();\n\n        font = new Font(scale, font);\n        const [r, g, b, a] = Image.colorToRGBA(color);\n\n        const layoutOptions = new Layout();\n\n        layoutOptions.reset({\n            max_width: layout.maxWidth,\n            max_height: layout.maxHeight,\n            wrap_style: layout.wrapStyle,\n            vertical_align: layout.verticalAlign,\n            horizontal_align: layout.horizontalAlign,\n            wrap_hard_breaks: layout.wrapHardBreaks\n        });\n\n        layoutOptions.append(font, text, {scale});\n        const framebuffer = layoutOptions.rasterize(r, g, b);\n        const image = new Image(framebuffer.width, framebuffer.height);\n\n        image.bitmap.set(framebuffer.buffer);\n\n        if (image.height > layout.maxHeight)\n            image.crop(0, 0, image.width, Math.floor(layoutOptions.lines() / image.height * layout.maxHeight) * (image.height / layoutOptions.lines()));\n\n        font.free();\n        layoutOptions.free();\n        return image.opacity(a / 0xff);\n    }\n\n}\n\n/**\n * Represents a frame in a GIF\n * @extends Image\n */\n class Frame extends Image {\n    /**\n     * GIF frame disposal mode KEEP. For use with {@link Frame}\n     * @returns {string}\n     */\n    static get DISPOSAL_KEEP() {\n        return 'keep';\n    }\n\n    /**\n     * GIF frame disposal mode PREVIOUS. For use with {@link Frame}\n     * @returns {string}\n     */\n    static get DISPOSAL_PREVIOUS() {\n        return 'previous';\n    }\n\n    /**\n     * GIF frame disposal mode BACKGROUND. For use with {@link Frame}\n     * @returns {string}\n     */\n    static get DISPOSAL_BACKGROUND() {\n        return 'background';\n    }\n\n    static __convert_disposal_mode__(mode) {\n        if (typeof mode === 'string')\n            mode = ['any', 'keep', 'previous', 'background'].indexOf(mode);\n        if (mode < 0 || mode > 3)\n            throw new RangeError('Invalid disposal mode');\n\n        return mode;\n    }\n\n    \n\n    /**\n     * Creates a new, blank frame\n     * @param {number} width\n     * @param {number} height\n     * @param {number} [duration = 100] The frames duration (in ms)\n     * @param {number} [xOffset=0] The frames offset on the x-axis\n     * @param {number} [yOffset=0] The frames offset on the y-axis\n     * @param {string|number} [disposalMode=Frame.DISPOSAL_KEEP] The frame's disposal mode ({@link Frame.DISPOSAL_KEEP}, {@link Frame.DISPOSAL_PREVIOUS} or {@link Frame.DISPOSAL_BACKGROUND})\n     * @return {Frame}\n     */\n    constructor(width, height, duration = 100, xOffset = 0, yOffset = 0, disposalMode = Frame.DISPOSAL_KEEP) {\n        if (isNaN(duration) || duration < 0)\n            throw new RangeError('Invalid frame duration');\n\n        super(width, height);\n        this.duration = duration;\n        this.xOffset = xOffset;\n        this.yOffset = yOffset;\n        this.disposalMode = disposalMode;\n    }\n\n    /**\n     * The Frame's disposal mode\n     * @returns {number}\n     */\n    get disposalMode() {\n        return this.__disposalMode__;\n    }\n\n    /**\n     * Sets the frame's disposal mode, converting it to the internal numeric value.\n     * @param {string|number} disposalMode The frame's disposal mode\n     */\n    set disposalMode(disposalMode) {\n        this.__disposalMode__ = Frame.__convert_disposal_mode__(disposalMode);\n    }\n\n    toString() {\n        return `Frame<${this.width}x${this.height}x${this.duration}ms>`;\n    }\n\n    /**\n     * Converts an Image instance to a Frame, cloning it in the process\n     * @param {Image} image The image to create the frame from\n     * @param {number} [duration = 100] The frames duration (in ms)\n     * @param {number} [xOffset=0] The frames offset on the x-axis\n     * @param {number} [yOffset=0] The frames offset on the y-axis\n     * @param {string|number} [disposalMode=Frame.DISPOSAL_KEEP] The frames disposal mode ({@link Frame.DISPOSAL_KEEP}, {@link Frame.DISPOSAL_PREVIOUS} or {@link Frame.DISPOSAL_BACKGROUND})\n     * @return {Frame}\n     */\n    static from(image, duration, xOffset, yOffset, disposalMode = Frame.DISPOSAL_KEEP) {\n        if (!(image instanceof Image))\n            throw new TypeError('Invalid image passed');\n\n        const frame = new Frame(image.width, image.height, duration, xOffset, yOffset, disposalMode);\n        frame.bitmap.set(image.bitmap);\n\n        return frame;\n    }\n\n    resize(width, height, mode = Image.RESIZE_NEAREST_NEIGHBOR) {\n        const originalWidth = this.width;\n        const originalHeight = this.height;\n\n        const result = super.resize(width, height, mode);\n\n        this.xOffset *= result.width / originalWidth;\n        this.yOffset *= result.height / originalHeight;\n\n        return result;\n    }\n}\n\n/**\n * Represents a GIF image as an array of frames\n * @extends Array<Frame>\n */\nclass GIF extends Array {\n    /**\n     * Creates a new GIF image.\n     * @param {Frame[]} frames The frames to create the GIF from\n     * @param {number} [loopCount=0] How often to loop the GIF for (-1 = unlimited)\n     * @property {number} loopCount How often the GIF will loop for\n     */\n    constructor(frames, loopCount = -1) {\n        super(...frames);\n\n        for (const frame of this)\n            if (!(frame instanceof Frame))\n                throw new TypeError(`Frame ${this.indexOf(frame)} is not an instance of Frame`);\n\n        if (loopCount < -1 || isNaN(loopCount))\n            throw new RangeError('Invalid loop count');\n\n        this.loopCount = loopCount;\n    }\n\n    /**\n     * The GIFs width\n     * @returns {number}\n     */\n    get width() {\n        let max = 0;\n        for (const frame of this) {\n            let width = frame.width + frame.xOffset;\n            if (max < width)\n                max = width;\n        }\n\n        return max;\n    }\n\n    /**\n     * The GIFs height\n     * @returns {number}\n     */\n    get height() {\n        let max = 0;\n        for (const frame of this) {\n            let height = frame.height + frame.yOffset;\n            if (max < height)\n                max = height;\n        }\n\n        return max;\n    }\n\n    toString() {\n        return `GIF<${this.width}x${this.height}x${this.duration}ms>`;\n    }\n\n    /**\n     * @returns {Generator<Frame, void, *>}\n     */\n    * [Symbol.iterator]() {\n        for (let i = 0; i < this.length; i++)\n            yield this[i];\n    }\n\n    slice(start, end) {\n        if (end === Infinity)\n            end = this.length;\n        const frames = new Array(end - start);\n        for (let i = 0; i < frames.length; i++)\n            frames[i] = this[i + start];\n        return new GIF(frames, this.loopCount);\n    }\n\n    /**\n     * The GIFs duration (in ms)\n     * @return {number}\n     */\n    get duration() {\n        return this.reduce((acc, frame) => acc + frame.duration, 0);\n    }\n\n    /**\n     * Encodes the image into a GIF\n     * @param {number} [quality=95] GIF quality 0-100\n     * @return {Promise<Uint8Array>} The encoded data\n     */\n    async encode(quality = 95) {\n        const encoder = new (await giflib.init()).Encoder(this.width, this.height, this.loopCount);\n\n        for (const frame of this) {\n            if (!(frame instanceof Frame)) throw new Error('GIF contains invalid frames');\n            encoder.add(frame.xOffset, frame.yOffset, ~~(frame.duration / 10), frame.width, frame.height, frame.bitmap, frame.disposalMode, quality / 100 * 29 + 1);\n        }\n\n        return encoder.u8();\n    }\n\n    /**\n     * Decodes a GIF image\n     * @param {Buffer|Uint8Array} data The binary data to decode\n     * @param {boolean} [onlyExtractFirstFrame=false] Whether to end GIF decoding after the first frame\n     * @return {Promise<GIF>} The decoded GIF\n     */\n    static async decode(data, onlyExtractFirstFrame = false) {\n        let image;\n        data = mem.view(data);\n        const view = new DataView(data.buffer, data.byteOffset, data.byteLength);\n\n        if (ImageType.isGIF(view)) { // GIF\n            const frames = [];\n            const decoder = new (await giflib.init()).Decoder(data);\n\n            if (onlyExtractFirstFrame) {\n                const first = decoder.frames().next().value;\n                const frame = new Frame(first.width, first.height, 10 * first.delay, first.x, first.y, first.dispose);\n\n                frame.bitmap.set(first.buffer);\n\n                frames.push(frame);\n                image = new GIF(frames);\n            }\n\n            const gwidth = decoder.width | 0;\n            const gheight = decoder.height | 0;\n            const u32 = new Uint32Array(decoder.width * decoder.height);\n            const u8 = new Uint8Array(u32.buffer, u32.byteOffset, u32.byteLength);\n\n            for (const frame of decoder.frames()) {\n                let offset8 = 0 | 0;\n                let offset32 = 0 | 0;\n                const fx = frame.x | 0;\n                const fy = frame.y | 0;\n                const f8 = frame.buffer;\n                const mode = frame.dispose;\n                const width = frame.width | 0;\n                const height = frame.height | 0;\n                const f32 = new Uint32Array(f8.buffer, f8.byteOffset, width * height);\n                const f = frames[frames.push(new Frame(gwidth, gheight, 10 * frame.delay, 0, 0, 3)) - 1];\n\n                const t8 = f.bitmap;\n                const t32 = new Uint32Array(t8.buffer);\n\n                t8.set(u8);\n\n                if (2 === mode) {\n                    for (let y = 0 | 0; y < height; y++) {\n                        const y_offset = fx + gwidth * (y + fy) | 0;\n\n                        for (let x = 0 | 0; x < width; x++) {\n                            const x_offset = x + y_offset;\n\n                            if (0 === f8[3 + offset8])\n                            t32[x_offset] = u32[x_offset];\n                            else t32[x_offset] = f32[offset32];\n\n                            offset32++;\n                            offset8 += 4;\n                        }\n                    }\n                }\n\n                else if (3 === mode) {\n                    for (let y = 0 | 0; y < height; y++) {\n                        const y_offset = fx + gwidth * (y + fy) | 0;\n\n                        for (let x = 0 | 0; x < width; x++) {\n                            const x_offset = x + y_offset;\n\n                            if (0 === f8[3 + offset8])\n                            t32[x_offset] = u32[x_offset];\n                            else t32[x_offset] = f32[offset32];\n\n                            offset32++;\n                            offset8 += 4;\n                            u32[x_offset] = 0;\n                        }\n                    }\n                }\n\n                else if (0 === mode || 1 === mode) {\n                    t8.set(u8);\n                    for (let y = 0 | 0; y < height; y++) {\n                        const y_offset = fx + gwidth * (y + fy) | 0;\n\n                        for (let x = 0 | 0; x < width; x++) {\n                            const x_offset = x + y_offset;\n\n                            if (0 === f8[3 + offset8])\n                            t32[x_offset] = u32[x_offset];\n                            else t32[x_offset] = f32[offset32];\n\n                            offset32++;\n                            offset8 += 4;\n                            u32[x_offset] = t32[x_offset];\n                        }\n                    }\n                }\n            }\n\n            image = new GIF(frames);\n        } else throw new Error('Unsupported image type');\n\n        return image;\n    }\n\n    resize(width, height, mode = Image.RESIZE_NEAREST_NEIGHBOR) {\n        for (const frame of this)\n            frame.resize(width, height, mode);\n    }\n}\n\nclass TextLayout {\n    /**\n     * Layout options for {@link renderText}\n     * @param {object} [options]\n     * @param {number} [options.maxWidth=Infinity] The texts max width\n     * @param {number} [options.maxHeight=Infinity] The texts max height\n     * @param {string} [options.wrapStyle='word'] The texts wrap style when reaching the max width (word, char)\n     * @param {string} [options.verticalAlign='left'] The vertical align mode (left, center, right)\n     * @param {string} [options.horizontalAlign='top'] The horizontal align mode (top, middle, bottom)\n     * @param {string} [options.wrapHardBreaks=true] Whether to force wrap at new line characters\n     */\n    constructor(options) {\n        const {maxWidth, maxHeight, wrapStyle, verticalAlign, horizontalAlign, wrapHardBreaks} = options || {};\n\n        this.maxWidth = maxWidth || Infinity;\n        if (isNaN(this.maxWidth) || this.maxWidth < 1)\n            throw new RangeError('Invalid maxWidth');\n\n        this.maxHeight = maxHeight || Infinity;\n        if (isNaN(this.maxHeight) || this.maxHeight < 1)\n            throw new RangeError('Invalid maxHeight');\n\n        this.wrapStyle = wrapStyle || 'word';\n        if (!['word', 'char'].includes(this.wrapStyle))\n            throw new RangeError('Invalid wrapStyle');\n\n        this.verticalAlign = verticalAlign || 'left';\n        if (!['left', 'center', 'right'].includes(this.verticalAlign))\n            throw new RangeError('Invalid verticalAlign');\n\n        this.horizontalAlign = horizontalAlign || 'top';\n        if (!['top', 'middle', 'bottom'].includes(this.horizontalAlign))\n            throw new RangeError('Invalid horizontalAlign');\n\n        this.wrapHardBreaks = typeof wrapHardBreaks === 'undefined' ? true : wrapHardBreaks;\n        if (typeof this.wrapHardBreaks !== 'boolean')\n            throw new TypeError('Invalid wrapHardBreaks');\n    }\n}\n\nclass ImageType {\n    /**\n     * Gets an images type (png, jpeg, tiff, gif)\n     * @param {Buffer|Uint8Array} data The image binary to get the type of\n     * @returns {string|null} The image type (png, jpeg, tiff, gif, null)\n     */\n    static getType(data) {\n        let view;\n        if (!ArrayBuffer.isView(data)) {\n            data = new Uint8Array(data);\n            view = new DataView(data.buffer);\n        } else {\n            data = new Uint8Array(data.buffer, data.byteOffset, data.byteLength);\n            view = new DataView(data.buffer, data.byteOffset, data.byteLength);\n        }\n\n        if (this.isPNG(view)) return 'png';\n        if (this.isJPEG(view)) return 'jpeg';\n        if (this.isTIFF(view)) return 'tiff';\n        if (this.isGIF(view)) return 'gif';\n        return null;\n    }\n\n    /**\n     * @param {DataView} view\n     * @returns {boolean}\n     */\n    static isPNG(view) {\n        return view.getUint32(0, false) === MAGIC_NUMBERS.PNG;\n    }\n\n    /**\n     * @param {DataView} view\n     * @returns {boolean}\n     */\n    static isJPEG(view) {\n        return (view.getUint32(0, false) >>> 8) === MAGIC_NUMBERS.JPEG;\n    }\n\n    /**\n     * @param {DataView} view\n     * @returns {boolean}\n     */\n    static isTIFF(view) {\n        return view.getUint32(0, false) === MAGIC_NUMBERS.TIFF;\n    }\n\n    /**\n     * @param {DataView} view\n     * @returns {boolean}\n     */\n    static isGIF(view) {\n        return (view.getUint32(0, false) >>> 8) === MAGIC_NUMBERS.GIF;\n    }\n}\n\n/**\n * Decodes the given image binary\n * @param {Uint8Array|Buffer} data The image data\n * @param {boolean} [onlyExtractFirstFrame] Whether to end GIF decoding after the first frame\n * @returns {Promise<GIF|Image>} The decoded image\n */\nfunction decode(data, onlyExtractFirstFrame) {\n    const type = ImageType.getType(data);\n\n    if (type === 'gif')\n        return GIF.decode(data, onlyExtractFirstFrame);\n    return Image.decode(data);\n}\n\nmodule.exports = {Image, GIF, Frame, TextLayout, ImageType, decode};\n","function view(buffer, shared = false) {\n    if (buffer instanceof ArrayBuffer) return new Uint8Array(buffer);\n    if (shared && buffer instanceof SharedArrayBuffer) return new Uint8Array(buffer);\n    if (ArrayBuffer.isView(buffer)) return new Uint8Array(buffer.buffer, buffer.byteOffset, buffer.byteLength);\n  \n    throw new TypeError(\"The provided value is not of type '(ArrayBuffer or ArrayBufferView)'\");\n  }\n  \n  function from_parts(buffers, shared = false) {\n    let length = 0;\n    let offset = 0;\n    buffers.forEach(buffer => length += (null == buffer.byteLength ? buffer.length : buffer.byteLength));\n  \n    const u8 = new Uint8Array(shared ? new SharedArrayBuffer(length) : length);\n  \n    buffers.forEach(buffer => {\n      const ref = Array.isArray(buffer) ? buffer : view(buffer, true);\n  \n      u8.set(ref, offset);\n      offset += ref.length;\n    });\n  \n    return u8;\n  }\n  \n  module.exports = { view, from_parts };","const table = new Uint32Array([\n    0x00000000, 0x77073096, 0xEE0E612C, 0x990951BA, 0x076DC419, 0x706AF48F, 0xE963A535, 0x9E6495A3, 0x0EDB8832,\n    0x79DCB8A4, 0xE0D5E91E, 0x97D2D988, 0x09B64C2B, 0x7EB17CBD, 0xE7B82D07, 0x90BF1D91, 0x1DB71064, 0x6AB020F2,\n    0xF3B97148, 0x84BE41DE, 0x1ADAD47D, 0x6DDDE4EB, 0xF4D4B551, 0x83D385C7, 0x136C9856, 0x646BA8C0, 0xFD62F97A,\n    0x8A65C9EC, 0x14015C4F, 0x63066CD9, 0xFA0F3D63, 0x8D080DF5, 0x3B6E20C8, 0x4C69105E, 0xD56041E4, 0xA2677172,\n    0x3C03E4D1, 0x4B04D447, 0xD20D85FD, 0xA50AB56B, 0x35B5A8FA, 0x42B2986C, 0xDBBBC9D6, 0xACBCF940, 0x32D86CE3,\n    0x45DF5C75, 0xDCD60DCF, 0xABD13D59, 0x26D930AC, 0x51DE003A, 0xC8D75180, 0xBFD06116, 0x21B4F4B5, 0x56B3C423,\n    0xCFBA9599, 0xB8BDA50F, 0x2802B89E, 0x5F058808, 0xC60CD9B2, 0xB10BE924, 0x2F6F7C87, 0x58684C11, 0xC1611DAB,\n    0xB6662D3D, 0x76DC4190, 0x01DB7106, 0x98D220BC, 0xEFD5102A, 0x71B18589, 0x06B6B51F, 0x9FBFE4A5, 0xE8B8D433,\n    0x7807C9A2, 0x0F00F934, 0x9609A88E, 0xE10E9818, 0x7F6A0DBB, 0x086D3D2D, 0x91646C97, 0xE6635C01, 0x6B6B51F4,\n    0x1C6C6162, 0x856530D8, 0xF262004E, 0x6C0695ED, 0x1B01A57B, 0x8208F4C1, 0xF50FC457, 0x65B0D9C6, 0x12B7E950,\n    0x8BBEB8EA, 0xFCB9887C, 0x62DD1DDF, 0x15DA2D49, 0x8CD37CF3, 0xFBD44C65, 0x4DB26158, 0x3AB551CE, 0xA3BC0074,\n    0xD4BB30E2, 0x4ADFA541, 0x3DD895D7, 0xA4D1C46D, 0xD3D6F4FB, 0x4369E96A, 0x346ED9FC, 0xAD678846, 0xDA60B8D0,\n    0x44042D73, 0x33031DE5, 0xAA0A4C5F, 0xDD0D7CC9, 0x5005713C, 0x270241AA, 0xBE0B1010, 0xC90C2086, 0x5768B525,\n    0x206F85B3, 0xB966D409, 0xCE61E49F, 0x5EDEF90E, 0x29D9C998, 0xB0D09822, 0xC7D7A8B4, 0x59B33D17, 0x2EB40D81,\n    0xB7BD5C3B, 0xC0BA6CAD, 0xEDB88320, 0x9ABFB3B6, 0x03B6E20C, 0x74B1D29A, 0xEAD54739, 0x9DD277AF, 0x04DB2615,\n    0x73DC1683, 0xE3630B12, 0x94643B84, 0x0D6D6A3E, 0x7A6A5AA8, 0xE40ECF0B, 0x9309FF9D, 0x0A00AE27, 0x7D079EB1,\n    0xF00F9344, 0x8708A3D2, 0x1E01F268, 0x6906C2FE, 0xF762575D, 0x806567CB, 0x196C3671, 0x6E6B06E7, 0xFED41B76,\n    0x89D32BE0, 0x10DA7A5A, 0x67DD4ACC, 0xF9B9DF6F, 0x8EBEEFF9, 0x17B7BE43, 0x60B08ED5, 0xD6D6A3E8, 0xA1D1937E,\n    0x38D8C2C4, 0x4FDFF252, 0xD1BB67F1, 0xA6BC5767, 0x3FB506DD, 0x48B2364B, 0xD80D2BDA, 0xAF0A1B4C, 0x36034AF6,\n    0x41047A60, 0xDF60EFC3, 0xA867DF55, 0x316E8EEF, 0x4669BE79, 0xCB61B38C, 0xBC66831A, 0x256FD2A0, 0x5268E236,\n    0xCC0C7795, 0xBB0B4703, 0x220216B9, 0x5505262F, 0xC5BA3BBE, 0xB2BD0B28, 0x2BB45A92, 0x5CB36A04, 0xC2D7FFA7,\n    0xB5D0CF31, 0x2CD99E8B, 0x5BDEAE1D, 0x9B64C2B0, 0xEC63F226, 0x756AA39C, 0x026D930A, 0x9C0906A9, 0xEB0E363F,\n    0x72076785, 0x05005713, 0x95BF4A82, 0xE2B87A14, 0x7BB12BAE, 0x0CB61B38, 0x92D28E9B, 0xE5D5BE0D, 0x7CDCEFB7,\n    0x0BDBDF21, 0x86D3D2D4, 0xF1D4E242, 0x68DDB3F8, 0x1FDA836E, 0x81BE16CD, 0xF6B9265B, 0x6FB077E1, 0x18B74777,\n    0x88085AE6, 0xFF0F6A70, 0x66063BCA, 0x11010B5C, 0x8F659EFF, 0xF862AE69, 0x616BFFD3, 0x166CCF45, 0xA00AE278,\n    0xD70DD2EE, 0x4E048354, 0x3903B3C2, 0xA7672661, 0xD06016F7, 0x4969474D, 0x3E6E77DB, 0xAED16A4A, 0xD9D65ADC,\n    0x40DF0B66, 0x37D83BF0, 0xA9BCAE53, 0xDEBB9EC5, 0x47B2CF7F, 0x30B5FFE9, 0xBDBDF21C, 0xCABAC28A, 0x53B39330,\n    0x24B4A3A6, 0xBAD03605, 0xCDD70693, 0x54DE5729, 0x23D967BF, 0xB3667A2E, 0xC4614AB8, 0x5D681B02, 0x2A6F2B94,\n    0xB40BBE37, 0xC30C8EA1, 0x5A05DF1B, 0x2D02EF8D]);\n  \n  module.exports = function crc32(buffer) {\n    let offset = 0 | 0;\n    let crc = 0xFFFFFFFF | 0;\n    const bl = (buffer.length - 4) | 0;\n  \n    while (bl > offset) {\n      crc = table[(crc ^ buffer[offset++]) & 0xff] ^ (crc >>> 8);\n      crc = table[(crc ^ buffer[offset++]) & 0xff] ^ (crc >>> 8);\n      crc = table[(crc ^ buffer[offset++]) & 0xff] ^ (crc >>> 8);\n      crc = table[(crc ^ buffer[offset++]) & 0xff] ^ (crc >>> 8);\n    }\n  \n    while (offset < buffer.length) {\n      crc = table[(crc ^ buffer[offset++]) & 0xff] ^ (crc >>> 8);\n    }\n  \n    return (crc ^ 0xFFFFFFFF) >>> 0;\n  };","/* global SharedArrayBuffer */\nconst mem = require('./buffer.js');\nconst crc32 = require('./crc32.js');\nconst { compress, decompress } = require('./zlib.js');\n\nconst __IHDR__ = new Uint8Array([73, 72, 68, 82]);\nconst __IDAT__ = new Uint8Array([73, 68, 65, 84]);\nconst __IEND__ = new Uint8Array([73, 69, 78, 68]);\nconst __IEND_CRC__ = crc32(new Uint8Array([73, 69, 78, 68]));\nconst HEAD = new Uint8Array([137, 80, 78, 71, 13, 10, 26, 10]);\n\nconst color_types = {\n  GREYSCALE: 0,\n  TRUECOLOR: 2,\n  INDEXED_COLOR: 3,\n  GREYSCALE_ALPHA: 4,\n  TRUECOLOR_ALPHA: 6\n};\n\nconst channels_to_color_type = {\n  1: color_types.GREYSCALE,\n  2: color_types.GREYSCALE_ALPHA,\n\n  3: color_types.TRUECOLOR,\n  4: color_types.TRUECOLOR_ALPHA\n};\n\nconst utf8encoder = new TextEncoder; // replace with latin1 encoder or iext\n\nmodule.exports = {\n  encode(data, { text, width, height, channels, depth = 8, level = 0 }) {\n    let offset = 0;\n    let tmp_offset = 0;\n    const row_length = width * channels;\n    const tmp = new Uint8Array(height + data.length);\n\n    while (offset < data.length) {\n      tmp[tmp_offset++] = 0;\n      tmp.set(data.subarray(offset, (offset += row_length)), tmp_offset);\n\n      tmp_offset += row_length;\n    }\n\n    if (text) {\n      let chunks = [];\n      for (const key in text) {\n        if (!text[key]) continue;\n        const kb = utf8encoder.encode(key);\n        const tb = utf8encoder.encode(text[key]);\n        const chunk = new Uint8Array(1 + 12 + kb.length + tb.length);\n\n        const view = new DataView(chunk.buffer);\n\n        chunk[4] = 0x74;\n        chunk[5] = 0x45;\n        chunk[6] = 0x58;\n        chunk[7] = 0x74;\n        chunk.set(kb, 8);\n        chunks.push(chunk);\n        chunk.set(tb, 9 + kb.length);\n        view.setUint32(0, chunk.length - 12);\n        view.setUint32(chunk.length - 4, crc32(chunk.subarray(4, chunk.length - 4)));\n      }\n\n      text = mem.from_parts(chunks);\n    }\n\n    offset = text ? text.length : 0;\n    const compressed = compress(tmp, level);\n    const array = new Uint8Array(49 + offset + HEAD.length + compressed.length);\n\n    array[26] = 0;\n    array[27] = 0;\n    array[28] = 0;\n    array[24] = depth;\n    array.set(HEAD, 0);\n    array.set(__IHDR__, 12);\n    array.set(__IDAT__, 37);\n    array.set(compressed, 41);\n    array[25] = channels_to_color_type[channels];\n    if (text) array.set(text, 45 + compressed.length);\n    array.set(__IEND__, 49 + offset + compressed.length);\n\n    const view = new DataView(array.buffer);\n\n    view.setUint32(8, 13);\n    view.setUint32(16, width);\n    view.setUint32(20, height);\n    view.setUint32(33, compressed.length);\n    view.setUint32(45 + offset + compressed.length, 0);\n    view.setUint32(53 + offset + compressed.length, __IEND_CRC__);\n    view.setUint32(29, crc32(new Uint8Array(array.buffer, 12, 17)));\n    view.setUint32(41 + compressed.length, crc32(new Uint8Array(array.buffer, 37, 4 + compressed.length)));\n\n    return array;\n  },\n\n  decode(array) {\n    let view = new DataView(array.buffer, array.byteOffset, array.byteLength);\n\n    const width = view.getUint32(16);\n    const height = view.getUint32(20);\n    const bpc = array[24];\n    const pixel_type = array[25];\n    let channels = ({ 3: 1, 0: 1, 4: 2, 2: 3, 6: 4 })[pixel_type];\n    const bytespp = channels * bpc / 8;\n\n    const row_length = width * bytespp;\n    let pixels = new Uint8Array(height * row_length);\n\n    let offset = 0;\n    let p_offset = 0;\n\n    let c_offset = 33;\n    const chunks = [];\n\n    let palette, alphaPalette;\n\n    const maxSearchOffset = array.length - 5;\n\n    let type;\n    while ((type = view.getUint32(4 + c_offset)) !== 1229278788) { // IEND\n      if (type === 1229209940) // IDAT\n        chunks.push(array.subarray(8 + c_offset, 8 + c_offset + view.getUint32(c_offset)));\n      else if (type === 1347179589) { // PLTE\n        if (palette)\n          throw new Error('PLTE can only occur once in an image');\n        palette = new Uint32Array(view.getUint32(c_offset));\n        for (let pxlOffset = 0; pxlOffset < palette.length * 8; pxlOffset += 3)\n          palette[pxlOffset / 3] = array[8 + c_offset + pxlOffset] << 24 | array[8 + c_offset + pxlOffset + 1] << 16 | array[8 + c_offset + pxlOffset + 2] << 8 | 0xff;\n      } else if (type === 1951551059) { // tRNS\n        if (alphaPalette)\n          throw new Error('tRNS can only occur once in an image');\n        alphaPalette = new Uint8Array(view.getUint32(c_offset));\n        for (let i = 0; i < alphaPalette.length; i++)\n          alphaPalette[i] = array[8 + c_offset + i];\n      }\n\n      c_offset += 4 + 4 + 4 + view.getUint32(c_offset);\n      if (c_offset > maxSearchOffset) // missing IEND\n        break;\n    }\n\n    array = decompress(chunks.length === 1 ? chunks[0] : mem.from_parts(chunks), height + height * row_length);\n\n    while (offset < array.byteLength) {\n      const filter = array[offset++];\n      const slice = array.subarray(offset, offset += row_length);\n\n      if (0 === filter) pixels.set(slice, p_offset);\n      else if (1 === filter) this.filter_1(slice, pixels, p_offset, bytespp, row_length);\n      else if (2 === filter) this.filter_2(slice, pixels, p_offset, bytespp, row_length);\n      else if (3 === filter) this.filter_3(slice, pixels, p_offset, bytespp, row_length);\n      else if (4 === filter) this.filter_4(slice, pixels, p_offset, bytespp, row_length);\n\n      p_offset += row_length;\n    }\n\n    if (pixel_type === 3) {\n      if (!palette)\n        throw new Error('Indexed color PNG has no PLTE');\n\n      if (alphaPalette)\n        for (let i = 0; i < alphaPalette.length; i++)\n          palette[i] &= 0xffffff00 | alphaPalette[i];\n\n      channels = 4;\n      const newPixels = new Uint8Array(width * height * 4);\n      const pixelView = new DataView(newPixels.buffer, newPixels.byteOffset, newPixels.byteLength);\n      for (let i = 0; i < pixels.length; i++)\n        pixelView.setUint32(i * 4, palette[pixels[i]], false);\n      pixels = newPixels;\n    }\n\n    if (bpc !== 8) {\n      const newPixels = new Uint8Array(pixels.length / bpc * 8);\n      for (let i = 0; i < pixels.length; i += 2)\n        newPixels[i / 2] = pixels[i];\n      pixels = newPixels;\n    }\n\n    if (channels !== 4) {\n      const newPixels = new Uint8Array(width * height * 4);\n      const view = new DataView(newPixels.buffer);\n\n      if (channels === 1) {\n        for (let i = 0; i < width * height; i++) {\n          const pixel = pixels[i];\n          view.setUint32(i * 4, pixel << 24 | pixel << 16 | pixel << 8 | 0xff, false);\n        }\n      } else if (channels === 2) {\n        for (let i = 0; i < width * height * 2; i += 2) {\n          const pixel = pixels[i];\n          view.setUint32(i * 2, pixel << 24 | pixel << 16 | pixel << 8 | pixels[i + 1], false);\n        }\n      } else if (channels === 3) {\n        newPixels.fill(0xff);\n        for (let i = 0; i < width * height; i++)\n          newPixels.set(pixels.subarray(i * 3, i * 3 + 3), i * 4);\n      }\n\n      pixels = newPixels;\n    }\n\n    return { width, height, pixels };\n  },\n\n  filter_1(slice, pixels, p_offset, bytespp, row_length) {\n    let i = 0;\n    while (i < bytespp) pixels[i + p_offset] = slice[i++];\n    while (i < row_length) pixels[i + p_offset] = slice[i] + pixels[i++ + p_offset - bytespp];\n  },\n\n  filter_2(slice, pixels, p_offset, bytespp, row_length) {\n    if (0 === p_offset) pixels.set(slice, p_offset);\n    else {\n      let i = 0;\n      while (i < row_length) pixels[i + p_offset] = slice[i] + pixels[i++ + p_offset - row_length];\n    }\n  },\n\n  filter_3(slice, pixels, p_offset, bytespp, row_length) {\n    let i = 0;\n\n    if (0 === p_offset) {\n      while (i < bytespp) pixels[i] = slice[i++];\n      while (i < row_length) pixels[i] = slice[i] + (pixels[i++ - bytespp] >> 1);\n    } else {\n      while (i < bytespp) pixels[i + p_offset] = slice[i] + (pixels[i++ + p_offset - row_length] >> 1);\n      while (i < row_length) pixels[i + p_offset] = slice[i] + (pixels[i + p_offset - bytespp] + pixels[i++ + p_offset - row_length] >> 1);\n    }\n  },\n\n  filter_4(slice, pixels, p_offset, bytespp, row_length) {\n    let i = 0;\n\n    if (0 === p_offset) {\n      while (i < bytespp) pixels[i] = slice[i++];\n      while (i < row_length) pixels[i] = slice[i] + pixels[i++ - bytespp];\n    } else {\n      while (i < bytespp) pixels[i + p_offset] = slice[i] + pixels[i++ + p_offset - row_length];\n\n      while (i < row_length) {\n        const a = pixels[i + p_offset - bytespp];\n        const b = pixels[i + p_offset - row_length];\n        const c = pixels[i + p_offset - bytespp - row_length];\n\n        const p = a + b - c;\n        const pa = Math.abs(p - a);\n        const pb = Math.abs(p - b);\n        const pc = Math.abs(p - c);\n\n        pixels[i + p_offset] = slice[i++] + ((pa <= pb && pa <= pc) ? a : ((pb <= pc) ? b : c));\n      }\n    }\n  }\n};","const { version } = require('../../package.json');\n\nlet mod = null;\nmodule.exports = {\n  async init() {\n    if (!mod) {\n      const streaming = 'compileStreaming' in WebAssembly;\n      mod = await WebAssembly[!streaming ? 'compile' : 'compileStreaming'](await fetch(`https://unpkg.com/imagescript@${version}/wasm/any/font.wasm`).then(x => streaming ? x : x.arrayBuffer()));\n    }\n\n    return this.new();\n  },\n\n  new() {\n    let registry = null;\n    const wasm = new WebAssembly.Instance(mod).exports;\n\n    class mem {\n      static length() { return wasm.wlen(); }\n      static alloc(size) { return wasm.walloc(size); }\n      static free(ptr, size) { return wasm.wfree(ptr, size); }\n      static u8(ptr, size) { return new Uint8Array(wasm.memory.buffer, ptr, size); }\n      static u32(ptr, size) { return new Uint32Array(wasm.memory.buffer, ptr, size); }\n\n      static copy_and_free(ptr, size) {\n        let slice = mem.u8(ptr, size).slice();\n        return (wasm.wfree(ptr, size), slice);\n      }\n    }\n    const encode_utf8 = 'Deno' in globalThis ? Deno.core.encode : (() => {\n      const encoder = new TextEncoder();\n      return string => encoder.encode(string);\n    })();\n\n    const decode_utf8 = 'Deno' in globalThis ? Deno.core.decode : (() => {\n      const decoder = new TextDecoder();\n      return buffer => decoder.decode(buffer);\n    })();\n\n    if ('FinalizationRegistry' in globalThis) {\n      registry = new FinalizationRegistry(([t, ptr]) => {\n        if (t === 0) wasm.font_free(ptr);\n        if (t === 1) wasm.layout_free(ptr);\n      });\n    }\n\n    class Font {\n      constructor(scale, buffer) {\n        this.scale = scale;\n        const ptr = mem.alloc(buffer.length);\n        mem.u8(ptr, buffer.length).set(buffer);\n        this.ptr = wasm.font_new(ptr, buffer.length, scale);\n\n        if (!this.ptr) throw new Error('invalid font');\n        if (registry) registry.register(this, [0, this.ptr], this);\n      }\n\n      free() {\n        this.ptr = wasm.font_free(this.ptr);\n        if (registry) registry.unregister(this);\n      }\n\n      has(char) {\n        return wasm.font_has(this.ptr, String.prototype.charCodeAt.call(char, 0));\n      }\n\n      metrics(char, scale = this.scale) {\n        const ptr = wasm.font_metrics(this.ptr, String.prototype.charCodeAt.call(char, 0), scale);\n        const metrics = JSON.parse(decode_utf8(mem.u8(wasm.font_metrics_buffer(ptr), mem.length())));\n\n        return (wasm.font_metrics_free(ptr), metrics);\n      }\n\n      rasterize(char, scale = this.scale) {\n        const ptr = wasm.font_rasterize(this.ptr, String.prototype.charCodeAt.call(char, 0), scale);\n\n        const glyph = {\n          buffer: mem.u8(wasm.font_rasterize_buffer(ptr), mem.length()).slice(),\n          metrics: JSON.parse(decode_utf8(mem.u8(wasm.font_rasterize_metrics(ptr), mem.length()))),\n        }\n\n        return (wasm.font_rasterize_free(ptr), glyph);\n      }\n    }\n\n    class Layout {\n      constructor() {\n        this.ptr = wasm.layout_new();\n        if (registry) this.refs = [];\n        if (registry) registry.register(this, [1, this.ptr], this);\n      }\n\n      clear() {\n        wasm.layout_clear(this.ptr);\n        if (registry) this.refs.length = 0;\n      }\n\n      lines() {\n        return wasm.layout_lines(this.ptr);\n      }\n\n      free() {\n        if (registry) this.refs.length = 0;\n        this.ptr = wasm.layout_free(this.ptr);\n        if (registry) registry.unregister(this);\n      }\n\n      reset(options = {}) {\n        options = encode_utf8(JSON.stringify(options));\n\n        if (registry) this.refs.length = 0;\n        const ptr = mem.alloc(options.length);\n        mem.u8(ptr, options.length).set(options);\n        wasm.layout_reset(this.ptr, ptr, options.length);\n      }\n\n      append(font, text, init) {\n        text = encode_utf8(text);\n        const options = init || {};\n        if (registry) this.refs.push(font);\n        const ptr = mem.alloc(text.length);\n        mem.u8(ptr, text.length).set(text);\n        const has_color = ('r' in options) || ('g' in options) || ('b' in options);\n        wasm.layout_append(this.ptr, font.ptr, ptr, text.length, options.scale == null ? font.scale : options.scale, has_color, options.r, options.g, options.b);\n      }\n\n      rasterize(r, g, b) {\n        const ptr = wasm.layout_rasterize(this.ptr, r, g, b);\n\n        const framebuffer = {\n          width: wasm.layout_rasterize_width(ptr),\n          height: wasm.layout_rasterize_height(ptr),\n          buffer: mem.u8(wasm.layout_rasterize_buffer(ptr), mem.length()).slice(),\n        }\n\n        return (wasm.layout_rasterize_free(ptr), framebuffer);\n      }\n    }\n\n    return { Font, Layout };\n  },\n}","const { version } = require('../../package.json');\n\nlet mod = null;\nmodule.exports = {\n  async init() {\n    if (!mod) {\n      const streaming = 'compileStreaming' in WebAssembly;\n      mod = await WebAssembly[!streaming ? 'compile' : 'compileStreaming'](await fetch(`https://unpkg.com/imagescript@${version}/wasm/any/gif.wasm`).then(x => streaming ? x : x.arrayBuffer()));\n    };\n\n    return this.new();\n  },\n\n  new() {\n    const streams = new Map;\n    const utf8encoder = new TextEncoder;\n\n    const wasm = new WebAssembly.Instance(mod, {\n      env: {\n        push_to_stream(id, ptr) {\n          streams.get(id).cb(mem.u8(ptr, mem.length()).slice());\n        },\n      },\n    }).exports;\n\n    class mem {\n      static length() { return wasm.wlen(); }\n      static alloc(size) { return wasm.walloc(size); }\n      static free(ptr, size) { return wasm.wfree(ptr, size); }\n      static u8(ptr, size) { return new Uint8Array(wasm.memory.buffer, ptr, size); }\n      static u32(ptr, size) { return new Uint32Array(wasm.memory.buffer, ptr, size); }\n\n      static copy_and_free(ptr, size) {\n        let slice = mem.u8(ptr, size).slice();\n        return (wasm.wfree(ptr, size), slice);\n      }\n    }\n\n    class Encoder {\n      constructor(width, height, loops = -1) {\n        this.slices = [];\n        streams.set(0, this);\n        this.ptr = wasm.encoder_new(0, width, height, loops);\n      }\n\n      cb(buffer) {\n        this.slices.push(buffer);\n      }\n\n      free() {\n        this.ptr = wasm.encoder_free(this.ptr);\n        streams.delete(0);\n      }\n\n      u8() {\n        this.free();\n        let offset = 0;\n        const u8 = new Uint8Array(this.slices.reduce((sum, array) => sum + array.length, 0));\n\n        for (const x of this.slices) {\n          u8.set(x, offset);\n          offset += x.length;\n        }\n\n        return u8;\n      }\n\n      add(x, y, delay, width, height, buffer, dispose, quality) {\n        const ptr = mem.alloc(buffer.length);\n        mem.u8(ptr, buffer.length).set(buffer);\n        wasm.encoder_add(this.ptr, ptr, buffer.length, x, y, width, height, delay, dispose, quality);\n      }\n\n      set comment(comment) {\n        const buffer = utf8encoder.encode(comment);\n\n        const ptr = mem.alloc(buffer.length);\n        mem.u8(ptr, buffer.length).set(buffer);\n        wasm.encoder_add_comment(this.ptr, ptr, buffer.length);\n      }\n\n      set application(application) {\n        const buffer = utf8encoder.encode(application);\n\n        const ptr = mem.alloc(buffer.length);\n        mem.u8(ptr, buffer.length).set(buffer);\n        wasm.encoder_add_application(this.ptr, ptr, buffer.length);\n      }\n    }\n\n    class Decoder {\n      constructor(buffer, limit = 0) {\n        const bptr = mem.alloc(buffer.length);\n        mem.u8(bptr, buffer.length).set(buffer);\n        this.ptr = wasm.decoder_new(bptr, buffer.length, limit);\n        if (0 === this.ptr) throw new Error('gif: failed to parse gif header');\n\n        this.width = wasm.decoder_width(this.ptr);\n        this.height = wasm.decoder_height(this.ptr);\n      }\n\n      free() {\n        this.ptr = wasm.decoder_free(this.ptr);\n      }\n\n      *frames() {\n        let frame;\n        while (frame = this.frame()) yield frame;\n      }\n\n      frame() {\n        const ptr = wasm.decoder_frame(this.ptr);\n\n        if (1 === ptr) return null;\n        if (0 === ptr) throw (this.free(), new Error('gif: failed to decode frame'));\n\n        const framebuffer = {\n          x: wasm.decoder_frame_x(ptr),\n          y: wasm.decoder_frame_y(ptr),\n          delay: wasm.decoder_frame_delay(ptr),\n          width: wasm.decoder_frame_width(ptr),\n          height: wasm.decoder_frame_height(ptr),\n          dispose: wasm.decoder_frame_dispose(ptr),\n          buffer: mem.u8(wasm.decoder_frame_buffer(ptr), mem.length()).slice(),\n        };\n\n        return (wasm.decoder_frame_free(ptr), framebuffer);\n      }\n    }\n\n    return { Encoder, Decoder };\n  },\n}\n","const { version } = require('../../package.json');\n\nlet mod = null;\nmodule.exports = {\n  async init() {\n    if (!mod) {\n      const streaming = 'compileStreaming' in WebAssembly;\n      mod = await WebAssembly[!streaming ? 'compile' : 'compileStreaming'](await fetch(`https://unpkg.com/imagescript@${version}/wasm/any/jpeg.wasm`).then(x => streaming ? x : x.arrayBuffer()));\n    };\n\n    return this.new();\n  },\n\n  new() {\n    const wasm = new WebAssembly.Instance(mod).exports;\n\n    class mem {\n      static length() { return wasm.wlen(); }\n      static alloc(size) { return wasm.walloc(size); }\n      static free(ptr, size) { return wasm.wfree(ptr, size); }\n      static u8(ptr, size) { return new Uint8Array(wasm.memory.buffer, ptr, size); }\n      static u32(ptr, size) { return new Uint32Array(wasm.memory.buffer, ptr, size); }\n\n      static copy_and_free(ptr, size) {\n        let slice = mem.u8(ptr, size).slice();\n        return (wasm.wfree(ptr, size), slice);\n      }\n    }\n\n    function encode(buffer, width, height, quality) {\n      const ptr = mem.alloc(buffer.length);\n      mem.u8(ptr, buffer.length).set(buffer);\n      return mem.copy_and_free(wasm.encode(ptr, width, height, quality), mem.length());\n    }\n\n    function decode(buffer, width, height) {\n      const bptr = mem.alloc(buffer.length);\n      mem.u8(bptr, buffer.length).set(buffer);\n      const ptr = wasm.decode(bptr, buffer.length, width, height);\n\n      if (0 === ptr) throw new Error('jpg: failed to decode');\n      if (1 === ptr) throw new Error('jpg: failed to scale decoder');\n\n      const framebuffer = {\n        width: wasm.decode_width(ptr),\n        height: wasm.decode_height(ptr),\n        format: wasm.decode_format(ptr),\n        buffer: mem.u8(wasm.decode_buffer(ptr), mem.length()).slice(),\n      }\n\n      return (wasm.decode_free(ptr), framebuffer);\n    }\n\n    return { encode, decode };\n  },\n}","const { version } = require('../../package.json');\n\nlet mod = null;\nmodule.exports = {\n  async init() {\n    if (!mod) {\n      const streaming = 'compileStreaming' in WebAssembly;\n      mod = await WebAssembly[!streaming ? 'compile' : 'compileStreaming'](await fetch(`https://unpkg.com/imagescript@${version}/wasm/any/svg.wasm`).then(x => streaming ? x : x.arrayBuffer()));\n    };\n\n    return this.new();\n  },\n\n  new() {\n    const wasm = new WebAssembly.Instance(mod).exports;\n\n    class mem {\n      static length() { return wasm.wlen(); }\n      static alloc(size) { return wasm.walloc(size); }\n      static free(ptr, size) { return wasm.wfree(ptr, size); }\n      static u8(ptr, size) { return new Uint8Array(wasm.memory.buffer, ptr, size); }\n      static u32(ptr, size) { return new Uint32Array(wasm.memory.buffer, ptr, size); }\n\n      static copy_and_free(ptr, size) {\n        let slice = mem.u8(ptr, size).slice();\n        return (wasm.wfree(ptr, size), slice);\n      }\n    }\n\n    function rasterize(buffer, fit, scale) {\n      const bptr = mem.alloc(buffer.length);\n      mem.u8(bptr, buffer.length).set(buffer);\n      const ptr = wasm.rasterize(bptr, buffer.length, fit, scale);\n\n      if (0 === ptr) throw new Error('svg: failed to parse');\n      if (1 === ptr) throw new Error('svg: failed to rasterize');\n\n      const framebuffer = {\n        width: wasm.rasterize_width(ptr),\n        height: wasm.rasterize_height(ptr),\n        buffer: mem.u8(wasm.rasterize_buffer(ptr), mem.length()).slice(),\n      }\n\n      return (wasm.rasterize_free(ptr), framebuffer);\n    }\n\n    return { rasterize };\n  },\n}\n","const { version } = require('../../package.json');\n\nlet mod = null;\nmodule.exports = {\n\tasync init() {\n\t\tif (!mod) {\n\t\t\tconst streaming = 'compileStreaming' in WebAssembly;\n\t\t\tmod = await WebAssembly[!streaming ? 'compile' : 'compileStreaming'](await fetch(`https://unpkg.com/imagescript@${version}/wasm/any/tiff.wasm`).then(x => streaming ? x : x.arrayBuffer()));\n\t\t};\n\n\t\treturn this.new();\n\t},\n\n\tnew() {\n\t\tconst wasm = new WebAssembly.Instance(mod).exports;\n\n\t\tclass mem {\n\t\t\tstatic length() { return wasm.wlen(); }\n\t\t\tstatic alloc(size) { return wasm.walloc(size); }\n\t\t\tstatic free(ptr, size) { return wasm.wfree(ptr, size); }\n\t\t\tstatic u8(ptr, size) { return new Uint8Array(wasm.memory.buffer, ptr, size); }\n\t\t\tstatic u32(ptr, size) { return new Uint32Array(wasm.memory.buffer, ptr, size); }\n\n\t\t\tstatic copy_and_free(ptr, size) {\n\t\t\t\tlet slice = mem.u8(ptr, size).slice();\n\t\t\t\treturn (wasm.wfree(ptr, size), slice);\n\t\t\t}\n\t\t}\n\n\t\tfunction decode(buffer) {\n\t\t\tconst bptr = mem.alloc(buffer.length);\n\t\t\tmem.u8(bptr, buffer.length).set(buffer);\n\t\t\tconst ptr = wasm.decode(bptr, buffer.length);\n\t\t\tif (0 === ptr) throw new Error('tiff: failed to decode');\n\n\t\t\tconst framebuffer = {\n\t\t\t\twidth: wasm.decode_width(ptr),\n\t\t\t\theight: wasm.decode_height(ptr),\n\t\t\t\tbuffer: mem.u8(wasm.decode_buffer(ptr), mem.length()).slice(),\n\t\t\t}\n\n\t\t\treturn (wasm.decode_free(ptr), framebuffer);\n\t\t}\n\n\t\treturn { decode };\n\t},\n}\n","// node_modules/fflate/esm/browser.js\n// https://github.com/101arrowz/fflate\n\n// MIT License\n\n// Copyright (c) 2020 Arjun Barrett\n\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the \"Software\"), to deal\n// in the Software without restriction, including without limitation the rights\n// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n// copies of the Software, and to permit persons to whom the Software is\n// furnished to do so, subject to the following conditions:\n\n// The above copyright notice and this permission notice shall be included in all\n// copies or substantial portions of the Software.\n\n\nvar u8 = Uint8Array;\nvar u16 = Uint16Array;\nvar u32 = Uint32Array;\nvar fleb = new u8([0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3, 4, 4, 4, 4, 5, 5, 5, 5, 0, 0, 0, 0]);\nvar fdeb = new u8([0, 0, 0, 0, 1, 1, 2, 2, 3, 3, 4, 4, 5, 5, 6, 6, 7, 7, 8, 8, 9, 9, 10, 10, 11, 11, 12, 12, 13, 13, 0, 0]);\nvar clim = new u8([16, 17, 18, 0, 8, 7, 9, 6, 10, 5, 11, 4, 12, 3, 13, 2, 14, 1, 15]);\nvar freb = function (eb, start) {\n  var b = new u16(31);\n  for (var i = 0; i < 31; ++i) {\n    b[i] = start += 1 << eb[i - 1];\n  }\n  var r = new u32(b[30]);\n  for (var i = 1; i < 30; ++i) {\n    for (var j = b[i]; j < b[i + 1]; ++j) {\n      r[j] = j - b[i] << 5 | i;\n    }\n  }\n  return [b, r];\n};\nvar _a = freb(fleb, 2);\nvar fl = _a[0];\nvar revfl = _a[1];\nfl[28] = 258, revfl[258] = 28;\nvar _b = freb(fdeb, 0);\nvar fd = _b[0];\nvar revfd = _b[1];\nvar rev = new u16(32768);\nfor (var i = 0; i < 32768; ++i) {\n  x = (i & 43690) >>> 1 | (i & 21845) << 1;\n  x = (x & 52428) >>> 2 | (x & 13107) << 2;\n  x = (x & 61680) >>> 4 | (x & 3855) << 4;\n  rev[i] = ((x & 65280) >>> 8 | (x & 255) << 8) >>> 1;\n}\nvar x;\nvar hMap = function (cd, mb, r) {\n  var s = cd.length;\n  var i = 0;\n  var l = new u16(mb);\n  for (; i < s; ++i)\n    ++l[cd[i] - 1];\n  var le = new u16(mb);\n  for (i = 0; i < mb; ++i) {\n    le[i] = le[i - 1] + l[i - 1] << 1;\n  }\n  var co;\n  if (r) {\n    co = new u16(1 << mb);\n    var rvb = 15 - mb;\n    for (i = 0; i < s; ++i) {\n      if (cd[i]) {\n        var sv = i << 4 | cd[i];\n        var r_1 = mb - cd[i];\n        var v = le[cd[i] - 1]++ << r_1;\n        for (var m = v | (1 << r_1) - 1; v <= m; ++v) {\n          co[rev[v] >>> rvb] = sv;\n        }\n      }\n    }\n  } else {\n    co = new u16(s);\n    for (i = 0; i < s; ++i) {\n      if (cd[i]) {\n        co[i] = rev[le[cd[i] - 1]++] >>> 15 - cd[i];\n      }\n    }\n  }\n  return co;\n};\nvar flt = new u8(288);\nfor (var i = 0; i < 144; ++i)\n  flt[i] = 8;\nfor (var i = 144; i < 256; ++i)\n  flt[i] = 9;\nfor (var i = 256; i < 280; ++i)\n  flt[i] = 7;\nfor (var i = 280; i < 288; ++i)\n  flt[i] = 8;\nvar fdt = new u8(32);\nfor (var i = 0; i < 32; ++i)\n  fdt[i] = 5;\nvar flm = hMap(flt, 9, 0);\nvar flrm = hMap(flt, 9, 1);\nvar fdm = hMap(fdt, 5, 0);\nvar fdrm = hMap(fdt, 5, 1);\nvar max = function (a) {\n  var m = a[0];\n  for (var i = 1; i < a.length; ++i) {\n    if (a[i] > m)\n      m = a[i];\n  }\n  return m;\n};\nvar bits = function (d, p, m) {\n  var o = p >> 3 | 0;\n  return (d[o] | d[o + 1] << 8) >> (p & 7) & m;\n};\nvar bits16 = function (d, p) {\n  var o = p >> 3 | 0;\n  return (d[o] | d[o + 1] << 8 | d[o + 2] << 16) >> (p & 7);\n};\nvar shft = function (p) {\n  return (p >> 3 | 0) + (p & 7 && 1);\n};\nvar slc = function (v, s, e) {\n  if (s == null || s < 0)\n    s = 0;\n  if (e == null || e > v.length)\n    e = v.length;\n  var n = new (v instanceof u16 ? u16 : v instanceof u32 ? u32 : u8)(e - s);\n  n.set(v.subarray(s, e));\n  return n;\n};\nvar inflt = function (dat, buf, st) {\n  var sl = dat.length;\n  if (!sl || st && !st.l && sl < 5)\n    return buf || new u8(0);\n  var noBuf = !buf || st;\n  var noSt = !st || st.i;\n  if (!st)\n    st = {};\n  if (!buf)\n    buf = new u8(sl * 3);\n  var cbuf = function (l2) {\n    var bl = buf.length;\n    if (l2 > bl) {\n      var nbuf = new u8(Math.max(bl * 2, l2));\n      nbuf.set(buf);\n      buf = nbuf;\n    }\n  };\n  var final = st.f || 0, pos = st.p || 0, bt = st.b || 0, lm = st.l, dm = st.d, lbt = st.m, dbt = st.n;\n  var tbts = sl * 8;\n  do {\n    if (!lm) {\n      st.f = final = bits(dat, pos, 1);\n      var type = bits(dat, pos + 1, 3);\n      pos += 3;\n      if (!type) {\n        var s = shft(pos) + 4, l = dat[s - 4] | dat[s - 3] << 8, t = s + l;\n        if (t > sl) {\n          if (noSt)\n            throw \"unexpected EOF\";\n          break;\n        }\n        if (noBuf)\n          cbuf(bt + l);\n        buf.set(dat.subarray(s, t), bt);\n        st.b = bt += l, st.p = pos = t * 8;\n        continue;\n      } else if (type === 1)\n        lm = flrm, dm = fdrm, lbt = 9, dbt = 5;\n      else if (type === 2) {\n        var hLit = bits(dat, pos, 31) + 257, hcLen = bits(dat, pos + 10, 15) + 4;\n        var tl = hLit + bits(dat, pos + 5, 31) + 1;\n        pos += 14;\n        var ldt = new u8(tl);\n        var clt = new u8(19);\n        for (var i = 0; i < hcLen; ++i) {\n          clt[clim[i]] = bits(dat, pos + i * 3, 7);\n        }\n        pos += hcLen * 3;\n        var clb = max(clt), clbmsk = (1 << clb) - 1;\n        var clm = hMap(clt, clb, 1);\n        for (var i = 0; i < tl;) {\n          var r = clm[bits(dat, pos, clbmsk)];\n          pos += r & 15;\n          var s = r >>> 4;\n          if (s < 16) {\n            ldt[i++] = s;\n          } else {\n            var c = 0, n = 0;\n            if (s === 16)\n              n = 3 + bits(dat, pos, 3), pos += 2, c = ldt[i - 1];\n            else if (s === 17)\n              n = 3 + bits(dat, pos, 7), pos += 3;\n            else if (s === 18)\n              n = 11 + bits(dat, pos, 127), pos += 7;\n            while (n--)\n              ldt[i++] = c;\n          }\n        }\n        var lt = ldt.subarray(0, hLit), dt = ldt.subarray(hLit);\n        lbt = max(lt);\n        dbt = max(dt);\n        lm = hMap(lt, lbt, 1);\n        dm = hMap(dt, dbt, 1);\n      } else\n        throw \"invalid block type\";\n      if (pos > tbts) {\n        if (noSt)\n          throw \"unexpected EOF\";\n        break;\n      }\n    }\n    if (noBuf)\n      cbuf(bt + 131072);\n    var lms = (1 << lbt) - 1, dms = (1 << dbt) - 1;\n    var lpos = pos;\n    for (; ; lpos = pos) {\n      var c = lm[bits16(dat, pos) & lms], sym = c >>> 4;\n      pos += c & 15;\n      if (pos > tbts) {\n        if (noSt)\n          throw \"unexpected EOF\";\n        break;\n      }\n      if (!c)\n        throw \"invalid length/literal\";\n      if (sym < 256)\n        buf[bt++] = sym;\n      else if (sym === 256) {\n        lpos = pos, lm = null;\n        break;\n      } else {\n        var add = sym - 254;\n        if (sym > 264) {\n          var i = sym - 257, b = fleb[i];\n          add = bits(dat, pos, (1 << b) - 1) + fl[i];\n          pos += b;\n        }\n        var d = dm[bits16(dat, pos) & dms], dsym = d >>> 4;\n        if (!d)\n          throw \"invalid distance\";\n        pos += d & 15;\n        var dt = fd[dsym];\n        if (dsym > 3) {\n          var b = fdeb[dsym];\n          dt += bits16(dat, pos) & (1 << b) - 1, pos += b;\n        }\n        if (pos > tbts) {\n          if (noSt)\n            throw \"unexpected EOF\";\n          break;\n        }\n        if (noBuf)\n          cbuf(bt + 131072);\n        var end = bt + add;\n        for (; bt < end; bt += 4) {\n          buf[bt] = buf[bt - dt];\n          buf[bt + 1] = buf[bt + 1 - dt];\n          buf[bt + 2] = buf[bt + 2 - dt];\n          buf[bt + 3] = buf[bt + 3 - dt];\n        }\n        bt = end;\n      }\n    }\n    st.l = lm, st.p = lpos, st.b = bt;\n    if (lm)\n      final = 1, st.m = lbt, st.d = dm, st.n = dbt;\n  } while (!final);\n  return bt === buf.length ? buf : slc(buf, 0, bt);\n};\nvar wbits = function (d, p, v) {\n  v <<= p & 7;\n  var o = p >> 3 | 0;\n  d[o] |= v;\n  d[o + 1] |= v >>> 8;\n};\nvar wbits16 = function (d, p, v) {\n  v <<= p & 7;\n  var o = p >> 3 | 0;\n  d[o] |= v;\n  d[o + 1] |= v >>> 8;\n  d[o + 2] |= v >>> 16;\n};\nvar hTree = function (d, mb) {\n  var t = [];\n  for (var i = 0; i < d.length; ++i) {\n    if (d[i])\n      t.push({ s: i, f: d[i] });\n  }\n  var s = t.length;\n  var t2 = t.slice();\n  if (!s)\n    return [et, 0];\n  if (s === 1) {\n    var v = new u8(t[0].s + 1);\n    v[t[0].s] = 1;\n    return [v, 1];\n  }\n  t.sort(function (a, b) {\n    return a.f - b.f;\n  });\n  t.push({ s: -1, f: 25001 });\n  var l = t[0], r = t[1], i0 = 0, i1 = 1, i2 = 2;\n  t[0] = { s: -1, f: l.f + r.f, l, r };\n  while (i1 !== s - 1) {\n    l = t[t[i0].f < t[i2].f ? i0++ : i2++];\n    r = t[i0 !== i1 && t[i0].f < t[i2].f ? i0++ : i2++];\n    t[i1++] = { s: -1, f: l.f + r.f, l, r };\n  }\n  var maxSym = t2[0].s;\n  for (var i = 1; i < s; ++i) {\n    if (t2[i].s > maxSym)\n      maxSym = t2[i].s;\n  }\n  var tr = new u16(maxSym + 1);\n  var mbt = ln(t[i1 - 1], tr, 0);\n  if (mbt > mb) {\n    var i = 0, dt = 0;\n    var lft = mbt - mb, cst = 1 << lft;\n    t2.sort(function (a, b) {\n      return tr[b.s] - tr[a.s] || a.f - b.f;\n    });\n    for (; i < s; ++i) {\n      var i2_1 = t2[i].s;\n      if (tr[i2_1] > mb) {\n        dt += cst - (1 << mbt - tr[i2_1]);\n        tr[i2_1] = mb;\n      } else\n        break;\n    }\n    dt >>>= lft;\n    while (dt > 0) {\n      var i2_2 = t2[i].s;\n      if (tr[i2_2] < mb)\n        dt -= 1 << mb - tr[i2_2]++ - 1;\n      else\n        ++i;\n    }\n    for (; i >= 0 && dt; --i) {\n      var i2_3 = t2[i].s;\n      if (tr[i2_3] === mb) {\n        --tr[i2_3];\n        ++dt;\n      }\n    }\n    mbt = mb;\n  }\n  return [new u8(tr), mbt];\n};\nvar ln = function (n, l, d) {\n  return n.s === -1 ? Math.max(ln(n.l, l, d + 1), ln(n.r, l, d + 1)) : l[n.s] = d;\n};\nvar lc = function (c) {\n  var s = c.length;\n  while (s && !c[--s])\n    ;\n  var cl = new u16(++s);\n  var cli = 0, cln = c[0], cls = 1;\n  var w = function (v) {\n    cl[cli++] = v;\n  };\n  for (var i = 1; i <= s; ++i) {\n    if (c[i] === cln && i !== s)\n      ++cls;\n    else {\n      if (!cln && cls > 2) {\n        for (; cls > 138; cls -= 138)\n          w(32754);\n        if (cls > 2) {\n          w(cls > 10 ? cls - 11 << 5 | 28690 : cls - 3 << 5 | 12305);\n          cls = 0;\n        }\n      } else if (cls > 3) {\n        w(cln), --cls;\n        for (; cls > 6; cls -= 6)\n          w(8304);\n        if (cls > 2)\n          w(cls - 3 << 5 | 8208), cls = 0;\n      }\n      while (cls--)\n        w(cln);\n      cls = 1;\n      cln = c[i];\n    }\n  }\n  return [cl.subarray(0, cli), s];\n};\nvar clen = function (cf, cl) {\n  var l = 0;\n  for (var i = 0; i < cl.length; ++i)\n    l += cf[i] * cl[i];\n  return l;\n};\nvar wfblk = function (out, pos, dat) {\n  var s = dat.length;\n  var o = shft(pos + 2);\n  out[o] = s & 255;\n  out[o + 1] = s >>> 8;\n  out[o + 2] = out[o] ^ 255;\n  out[o + 3] = out[o + 1] ^ 255;\n  for (var i = 0; i < s; ++i)\n    out[o + i + 4] = dat[i];\n  return (o + 4 + s) * 8;\n};\nvar wblk = function (dat, out, final, syms, lf, df, eb, li, bs, bl, p) {\n  wbits(out, p++, final);\n  ++lf[256];\n  var _a2 = hTree(lf, 15), dlt = _a2[0], mlb = _a2[1];\n  var _b2 = hTree(df, 15), ddt = _b2[0], mdb = _b2[1];\n  var _c = lc(dlt), lclt = _c[0], nlc = _c[1];\n  var _d = lc(ddt), lcdt = _d[0], ndc = _d[1];\n  var lcfreq = new u16(19);\n  for (var i = 0; i < lclt.length; ++i)\n    lcfreq[lclt[i] & 31]++;\n  for (var i = 0; i < lcdt.length; ++i)\n    lcfreq[lcdt[i] & 31]++;\n  var _e = hTree(lcfreq, 7), lct = _e[0], mlcb = _e[1];\n  var nlcc = 19;\n  for (; nlcc > 4 && !lct[clim[nlcc - 1]]; --nlcc)\n    ;\n  var flen = bl + 5 << 3;\n  var ftlen = clen(lf, flt) + clen(df, fdt) + eb;\n  var dtlen = clen(lf, dlt) + clen(df, ddt) + eb + 14 + 3 * nlcc + clen(lcfreq, lct) + (2 * lcfreq[16] + 3 * lcfreq[17] + 7 * lcfreq[18]);\n  if (flen <= ftlen && flen <= dtlen)\n    return wfblk(out, p, dat.subarray(bs, bs + bl));\n  var lm, ll, dm, dl;\n  wbits(out, p, 1 + (dtlen < ftlen)), p += 2;\n  if (dtlen < ftlen) {\n    lm = hMap(dlt, mlb, 0), ll = dlt, dm = hMap(ddt, mdb, 0), dl = ddt;\n    var llm = hMap(lct, mlcb, 0);\n    wbits(out, p, nlc - 257);\n    wbits(out, p + 5, ndc - 1);\n    wbits(out, p + 10, nlcc - 4);\n    p += 14;\n    for (var i = 0; i < nlcc; ++i)\n      wbits(out, p + 3 * i, lct[clim[i]]);\n    p += 3 * nlcc;\n    var lcts = [lclt, lcdt];\n    for (var it = 0; it < 2; ++it) {\n      var clct = lcts[it];\n      for (var i = 0; i < clct.length; ++i) {\n        var len = clct[i] & 31;\n        wbits(out, p, llm[len]), p += lct[len];\n        if (len > 15)\n          wbits(out, p, clct[i] >>> 5 & 127), p += clct[i] >>> 12;\n      }\n    }\n  } else {\n    lm = flm, ll = flt, dm = fdm, dl = fdt;\n  }\n  for (var i = 0; i < li; ++i) {\n    if (syms[i] > 255) {\n      var len = syms[i] >>> 18 & 31;\n      wbits16(out, p, lm[len + 257]), p += ll[len + 257];\n      if (len > 7)\n        wbits(out, p, syms[i] >>> 23 & 31), p += fleb[len];\n      var dst = syms[i] & 31;\n      wbits16(out, p, dm[dst]), p += dl[dst];\n      if (dst > 3)\n        wbits16(out, p, syms[i] >>> 5 & 8191), p += fdeb[dst];\n    } else {\n      wbits16(out, p, lm[syms[i]]), p += ll[syms[i]];\n    }\n  }\n  wbits16(out, p, lm[256]);\n  return p + ll[256];\n};\nvar deo = new u32([65540, 131080, 131088, 131104, 262176, 1048704, 1048832, 2114560, 2117632]);\nvar et = new u8(0);\nvar dflt = function (dat, lvl, plvl, pre, post, lst) {\n  var s = dat.length;\n  var o = new u8(pre + s + 5 * (1 + Math.ceil(s / 7e3)) + post);\n  var w = o.subarray(pre, o.length - post);\n  var pos = 0;\n  if (!lvl || s < 8) {\n    for (var i = 0; i <= s; i += 65535) {\n      var e = i + 65535;\n      if (e < s) {\n        pos = wfblk(w, pos, dat.subarray(i, e));\n      } else {\n        w[i] = lst;\n        pos = wfblk(w, pos, dat.subarray(i, s));\n      }\n    }\n  } else {\n    var opt = deo[lvl - 1];\n    var n = opt >>> 13, c = opt & 8191;\n    var msk_1 = (1 << plvl) - 1;\n    var prev = new u16(32768), head = new u16(msk_1 + 1);\n    var bs1_1 = Math.ceil(plvl / 3), bs2_1 = 2 * bs1_1;\n    var hsh = function (i2) {\n      return (dat[i2] ^ dat[i2 + 1] << bs1_1 ^ dat[i2 + 2] << bs2_1) & msk_1;\n    };\n    var syms = new u32(25e3);\n    var lf = new u16(288), df = new u16(32);\n    var lc_1 = 0, eb = 0, i = 0, li = 0, wi = 0, bs = 0;\n    for (; i < s; ++i) {\n      var hv = hsh(i);\n      var imod = i & 32767, pimod = head[hv];\n      prev[imod] = pimod;\n      head[hv] = imod;\n      if (wi <= i) {\n        var rem = s - i;\n        if ((lc_1 > 7e3 || li > 24576) && rem > 423) {\n          pos = wblk(dat, w, 0, syms, lf, df, eb, li, bs, i - bs, pos);\n          li = lc_1 = eb = 0, bs = i;\n          for (var j = 0; j < 286; ++j)\n            lf[j] = 0;\n          for (var j = 0; j < 30; ++j)\n            df[j] = 0;\n        }\n        var l = 2, d = 0, ch_1 = c, dif = imod - pimod & 32767;\n        if (rem > 2 && hv === hsh(i - dif)) {\n          var maxn = Math.min(n, rem) - 1;\n          var maxd = Math.min(32767, i);\n          var ml = Math.min(258, rem);\n          while (dif <= maxd && --ch_1 && imod !== pimod) {\n            if (dat[i + l] === dat[i + l - dif]) {\n              var nl = 0;\n              for (; nl < ml && dat[i + nl] === dat[i + nl - dif]; ++nl)\n                ;\n              if (nl > l) {\n                l = nl, d = dif;\n                if (nl > maxn)\n                  break;\n                var mmd = Math.min(dif, nl - 2);\n                var md = 0;\n                for (var j = 0; j < mmd; ++j) {\n                  var ti = i - dif + j + 32768 & 32767;\n                  var pti = prev[ti];\n                  var cd = ti - pti + 32768 & 32767;\n                  if (cd > md)\n                    md = cd, pimod = ti;\n                }\n              }\n            }\n            imod = pimod, pimod = prev[imod];\n            dif += imod - pimod + 32768 & 32767;\n          }\n        }\n        if (d) {\n          syms[li++] = 268435456 | revfl[l] << 18 | revfd[d];\n          var lin = revfl[l] & 31, din = revfd[d] & 31;\n          eb += fleb[lin] + fdeb[din];\n          ++lf[257 + lin];\n          ++df[din];\n          wi = i + l;\n          ++lc_1;\n        } else {\n          syms[li++] = dat[i];\n          ++lf[dat[i]];\n        }\n      }\n    }\n    pos = wblk(dat, w, lst, syms, lf, df, eb, li, bs, i - bs, pos);\n    if (!lst && pos & 7)\n      pos = wfblk(w, pos + 1, et);\n  }\n  return slc(o, 0, pre + shft(pos) + post);\n};\nvar adler = function () {\n  var a = 1, b = 0;\n  return {\n    p: function (d) {\n      var n = a, m = b;\n      var l = d.length | 0;\n      for (var i = 0; i !== l;) {\n        var e = Math.min(i + 2655, l);\n        for (; i < e; ++i)\n          m += n += d[i];\n        n = (n & 65535) + 15 * (n >> 16), m = (m & 65535) + 15 * (m >> 16);\n      }\n      a = n, b = m;\n    },\n    d: function () {\n      a %= 65521, b %= 65521;\n      return (a & 255) << 24 | a >>> 8 << 16 | (b & 255) << 8 | b >>> 8;\n    }\n  };\n};\nvar dopt = function (dat, opt, pre, post, st) {\n  return dflt(dat, opt.level == null ? 6 : opt.level, opt.mem == null ? Math.ceil(Math.max(8, Math.min(13, Math.log(dat.length))) * 1.5) : 12 + opt.mem, pre, post, !st);\n};\nvar wbytes = function (d, b, v) {\n  for (; v; ++b)\n    d[b] = v, v >>>= 8;\n};\nvar zlh = function (c, o) {\n  var lv = o.level, fl2 = lv === 0 ? 0 : lv < 6 ? 1 : lv === 9 ? 3 : 2;\n  c[0] = 120, c[1] = fl2 << 6 | (fl2 ? 32 - 2 * fl2 : 1);\n};\nvar zlv = function (d) {\n  if ((d[0] & 15) !== 8 || d[0] >>> 4 > 7 || (d[0] << 8 | d[1]) % 31)\n    throw \"invalid zlib data\";\n  if (d[1] & 32)\n    throw \"invalid zlib data: preset dictionaries not supported\";\n};\nfunction zlibSync(data, opts) {\n  if (!opts)\n    opts = {};\n  var a = adler();\n  a.p(data);\n  var d = dopt(data, opts, 2, 4);\n  return zlh(d, opts), wbytes(d, d.length - 4, a.d()), d;\n}\nfunction unzlibSync(data, out) {\n  return inflt((zlv(data), data.subarray(2, -4)), out);\n}\n\n// bundle.js\nfunction compress(buf, level) {\n  return zlibSync(buf, { level });\n}\n\nfunction decompress(buf, limit) {\n  return unzlibSync(buf, new Uint8Array(limit));\n}\n\nmodule.exports = {\n  compress,\n  decompress\n};\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// startup\n// Load entry module and return exports\n// This entry module is referenced by other modules so it can't be inlined\nvar __webpack_exports__ = __webpack_require__(860);\n"],"names":["root","factory","exports","module","define","amd","self","png","mem","giflib","svglib","version","fontlib","jpeglib","tifflib","Image","constructor","width","height","RangeError","this","__width__","__height__","__buffer__","ArrayBuffer","__view__","DataView","__u32__","Uint32Array","bitmap","Uint8ClampedArray","toString","Symbol","iterator","y","x","offset","getUint32","static","r","g","b","a","rgbaToColor","h","s","l","Math","min","max","hue2rgb","p","q","t","hslaToColor","d","color","colorToRGBA","slice","getPixelAt","__check_boundaries__","getRGBAAt","idx","subarray","setPixelAt","pixelColor","__set_pixel__","setUint32","isNaN","TypeError","__out_of_bounds__","fill","clone","image","set","RESIZE_NEAREST_NEIGHBOR","RESIZE_AUTO","scale","factor","mode","__scale__","__apply__","__resize__","resize","contain","scaleFactor","fit","result","composite","cover","crop","Error","floor","__resize_nearest_neighbor__","ySrc","xSrc","destPos","srcPos","__crop__","tY","drawBox","__fast_box__","tX","nX","nY","tC","right","xPos","end","start","bottom","copyWithin","drawCircle","radius","radSquared","currentY","currentX","cropCircle","feathering","centerX","centerY","distanceFromCenter","alphaIdx","opacity","absolute","__set_channel_value__","red","saturation","green","blue","value","i","length","lightness","rgbaToHSLA","source","yy","y_offset","xx","x_offset","fg","bg","__alpha_blend__","fa","alpha","inv_alpha","invert","iterateWithColors","invertValue","invertSaturation","invertHue","hueShift","degrees","averageColor","colorAvg","divisor","rgba","map","v","dominantColor","ignoreBlack","ignoreWhite","bwThreshold","colorCounts","Array","key","maxColorCount","mostProminentValue","forEach","el","rotate","angle","__rotate_180__","rad","PI","sin","cos","abs","out","out_cx","out_cy","src_cx","src_cy","w","ysin","ycos","xf","yf","__interpolate__","reverse","src","x0","y0","x1","y1","x2","y2","xq","yq","out_slice","ref","__pawn__","point0","point1","weight","src_slice","wa","Frame","from","duration","xOffset","yOffset","disposalMode","colors","entries","Object","sort","positions","e","parseFloat","values","gradient","__gradient__","position","minDef","maxDef","gradients","minPos","undefined","maxPos","minVal","maxVal","push","roundCorners","xRad","startColor","endColor","sr","sg","sb","sa","er","eg","eb","ea","fisheye","tu32","ru32","iw","ih","xco","yco","dfc","sqrt","dis","nx","ny","cO","async","compression","title","author","description","copyright","creationTime","software","disclaimer","warning","comment","encode","level","channels","text","Title","Author","Description","Copyright","Date","now","toUTCString","Software","Disclaimer","Warning","Source","Comment","quality","init","data","view","buffer","byteOffset","byteLength","ImageType","isPNG","pixels","decode","isJPEG","framebuffer","pixelType","format","pixel","isTIFF","SVG_MODE_SCALE","SVG_MODE_WIDTH","SVG_MODE_HEIGHT","svg","size","includes","TextEncoder","rasterize","font","layout","TextLayout","Font","Layout","layoutOptions","reset","max_width","maxWidth","max_height","maxHeight","wrap_style","wrapStyle","vertical_align","verticalAlign","horizontal_align","horizontalAlign","wrap_hard_breaks","wrapHardBreaks","append","lines","free","DISPOSAL_KEEP","DISPOSAL_PREVIOUS","DISPOSAL_BACKGROUND","indexOf","super","__disposalMode__","__convert_disposal_mode__","frame","originalWidth","originalHeight","GIF","frames","loopCount","Infinity","reduce","acc","encoder","Encoder","add","u8","onlyExtractFirstFrame","isGIF","decoder","Decoder","first","next","delay","dispose","gwidth","gheight","u32","Uint8Array","offset8","offset32","fx","fy","f8","f32","t8","t32","options","isView","getType","shared","SharedArrayBuffer","from_parts","buffers","isArray","table","crc","bl","crc32","compress","decompress","__IHDR__","__IDAT__","__IEND__","__IEND_CRC__","HEAD","channels_to_color_type","utf8encoder","depth","tmp_offset","row_length","tmp","chunks","kb","tb","chunk","compressed","array","bpc","pixel_type","bytespp","p_offset","c_offset","palette","alphaPalette","maxSearchOffset","type","pxlOffset","filter","filter_1","filter_2","filter_3","filter_4","newPixels","pixelView","c","pa","pb","pc","mod","streaming","WebAssembly","fetch","then","arrayBuffer","new","registry","wasm","Instance","wlen","walloc","ptr","wfree","memory","encode_utf8","globalThis","Deno","core","string","decode_utf8","TextDecoder","FinalizationRegistry","font_free","layout_free","alloc","font_new","register","unregister","has","char","font_has","String","prototype","charCodeAt","call","metrics","font_metrics","JSON","parse","font_metrics_buffer","font_metrics_free","font_rasterize","glyph","font_rasterize_buffer","font_rasterize_metrics","font_rasterize_free","layout_new","refs","clear","layout_clear","layout_lines","stringify","layout_reset","has_color","layout_append","layout_rasterize","layout_rasterize_width","layout_rasterize_height","layout_rasterize_buffer","layout_rasterize_free","streams","Map","env","push_to_stream","id","get","cb","loops","slices","encoder_new","encoder_free","delete","sum","encoder_add","encoder_add_comment","application","encoder_add_application","limit","bptr","decoder_new","decoder_width","decoder_height","decoder_free","decoder_frame","decoder_frame_x","decoder_frame_y","decoder_frame_delay","decoder_frame_width","decoder_frame_height","decoder_frame_dispose","decoder_frame_buffer","decoder_frame_free","copy_and_free","decode_width","decode_height","decode_format","decode_buffer","decode_free","rasterize_width","rasterize_height","rasterize_buffer","rasterize_free","u16","Uint16Array","fleb","fdeb","clim","freb","j","_a","fl","revfl","_b","fd","revfd","rev","hMap","cd","mb","co","le","rvb","sv","r_1","m","flt","fdt","flm","flrm","fdm","fdrm","bits","o","bits16","shft","slc","n","wbits","wbits16","hTree","f","t2","et","i0","i1","i2","maxSym","tr","mbt","ln","dt","lft","cst","i2_1","i2_2","i2_3","lc","cl","cli","cln","cls","clen","cf","wfblk","pos","dat","wblk","final","syms","lf","df","li","bs","_a2","dlt","mlb","_b2","ddt","mdb","_c","lclt","nlc","_d","lcdt","ndc","lcfreq","_e","lct","mlcb","nlcc","lm","ll","dm","dl","flen","ftlen","dtlen","llm","lcts","it","clct","len","dst","deo","buf","opts","adler","opt","pre","post","st","lv","fl2","lvl","plvl","lst","ceil","msk_1","prev","head","bs1_1","bs2_1","hsh","lc_1","wi","hv","imod","pimod","rem","ch_1","dif","maxn","maxd","ml","nl","mmd","md","ti","lin","din","dflt","log","wbytes","zlibSync","sl","noBuf","noSt","cbuf","l2","nbuf","bt","lbt","dbt","tbts","hLit","hcLen","tl","ldt","clt","clb","clbmsk","clm","lt","lms","dms","lpos","sym","dsym","inflt","zlv","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__"],"sourceRoot":""}